DATA16 FD_NATIVECODECOMMAND
DATA16 FD_NATIVECODERESPONSE
DATA32 STOPLCDUPDATE
DATA32 NUMMAILBOXES
ARRAY8 MOTORISINVERTED 4     
ARRAY8 FIRSTOF2  16
ARRAY16 LOCKS 2           
DATA32 s1out1
DATA32 s1out2
DATA32 s1out3
DATA32 s2out1
DATA32 s2out2
DATA32 s2out3
DATA32 s3out1
DATA32 s3out2
DATA32 s3out3
DATA32 s4out1
DATA32 s4out2
DATA32 s4out3
DATA32 getTachoA
DATA32 tmpTachoA
DATA8 getSpeedA
DATA8 setSpeedA
DATA8 setPowerA
DATA32 getTachoB
DATA32 tmpTachoB
DATA8 getSpeedB
DATA8 setSpeedB
DATA8 setPowerB
DATA32 getTachoC
DATA32 tmpTachoC
DATA8 getSpeedC
DATA8 setSpeedC
DATA8 setPowerC
DATA32 getTachoD
DATA32 tmpTachoD
DATA8 getSpeedD
DATA8 setSpeedD
DATA8 setPowerD
DATA16 newArray1d
DATA32 newSize1d
DATA32 newIndex1d
DATA32 timeMC1
DATA32 timeMC2
DATA32 timeMC3
DATA32 timeMC4
DATA32 timeMC5
DATA32 timeMC6
DATA32 timeMC7
DATA32 timeMC8
DATA32 timeMC9
DATA32 timeMC1tmp
DATA32 timeMC2tmp
DATA32 timeMC3tmp
DATA32 timeMC4tmp
DATA32 timeMC5tmp
DATA32 timeMC6tmp
DATA32 timeMC7tmp
DATA32 timeMC8tmp
DATA32 timeMC9tmp
DATAF VPR_GIRO_G1
DATAF VPR_RGB_VALUENEGRO
DATAF VPR_RGB_VALUEBLANCO
DATAF VPR_RGB_RWHITE
DATAF VPR_RGB_GWHITE
DATAF VPR_RGB_BWHITE
DATAF VPR_RECTO_DIAMETRO
DATAF VPR_GIRO_DIAMETRO
DATAF VPR_SIGUELINEAS_DIAMETRO
DATAF VPR_SMART_DIAMETRO
DATAF VPR_SIGUELINEAS_NEGRO1
DATAF VPR_SIGUELINEAS_NEGRO3
DATAF VPR_SIGUELINEAS_NEGRO4
DATAF VPR_SIGUELINEAS_BLANCO1
DATAF VPR_SIGUELINEAS_BLANCO3
DATAF VPR_SIGUELINEAS_BLANCO4
DATAF VPR_SMART_NEGRO1
DATAF VPR_SMART_NEGRO3
DATAF VPR_SMART_NEGRO4
DATAF VPR_SMART_BLANCO1
DATAF VPR_SMART_BLANCO3
DATAF VPR_SMART_BLANCO4
DATAF VPR_RECTO_NEGRO
DATAF VPR_RECTO_BLANCO
DATAF VPR_GIRO_NEGRO
DATAF VPR_GIRO_BLANCO
DATAF VLV_VELOCIDADA_6
DATAF VLV_VELOCIDADD_6
DATAF VLV_TIMER_6
DATAF VLV_VELOCIDAD_8
DATAF VLV_DISTANCIA_8
DATAF VLV_VELOCIDAD1_14
DATAF VLV_VELOCIDAD2_14
DATAF VLV_GRADOS_14
DATAF VLV_VELOCIDAD_9
DATAF VLV_DISTANCIA_9
DATAF VLV_VELOCIDAD_10
DATAF VLV_SENSOR_10
DATAF VLV_VELOCIDAD_16
DATAF VLV_VELOCIDAD_17
DATAF VLV_ENCODER_17
DATAF VLV_SENS_22
DATAF VLV_REPS_22
DATAF VLV_COLOR_22
DATAF VLV_COLOR_23
DATAF VLV_VELOCIDAD_11
DATAF VLV_TIEMPO_11
DATAF VLV_VELOCIDAD_7
DATAF VLV_ENCODER_7
DATAF VLV_VELOCIDAD_18
DATAF VLV_ENCODER_18
DATAF VLV_VELOCIDAD_19
DATAF VLV_READER_19
DATAF VLV_VELOCIDAD1_15
DATAF VLV_VELOCIDAD2_15
DATAF VLV_DISTANCIA_15
DATAF VLV_VELOCIDAD_20
DATAF VLV_READER_20
DATAF VLV_VELOCIDAD_21
DATAF VLV_ENCODER_21
DATAF VLV_V0_12
DATAF VLV_VMAX_12
DATAF VLV_DISTANCIAACCEL_12
DATAF VLV_DISTANCIACRUCERO_12
DATAF VLV_DISTANCIADECEL_12
DATAF VLV_V0_13
DATAF VLV_VMAX_13
DATAF VLV_DISTANCIAACCEL_13
DATAF VLV_DISTANCIACRUCERO_13
DATAF VLV_DISTANCIADECEL_13
DATAF VLV_NUMERO_2
DATAF VGV_MARKINGGRANDE
DATAF VGV_DIAMETRO
DATAF VGV_NEGRO1
DATAF VGV_NEGRO3
DATAF VGV_NEGRO4
DATAF VGV_BLANCO1
DATAF VGV_BLANCO3
DATAF VGV_BLANCO4
ARRAY16 VGV_MARKING 2
DATAF VLV_VOLTAJE_1
DATAF VLV_ENCDIFF_7
DATAF VLV_SIGNO_7
DATAF VLV_SAFETYTIMER_7
DATAF VLV_CORRECCION_8
DATAF VLV_ENC_8
DATAF VLV_CORRECCION_9
DATAF VLV_ENC_9
DATAF VLV_CORRECCION_10
DATAF VLV_LECTURA_10
DATAF VLV_CORRECCION_11
DATAF VLV_STARTB_12
DATAF VLV_STARTC_12
DATAF VLV_ENCODERB_12
DATAF VLV_ENCODERC_12
DATAF VLV_SIGNO_12
DATAF VLV_VEL_12
DATAF VLV_KP_12
DATAF VLV_KD_12
DATAF VLV_ERROR_12
DATAF VLV_OLDERROR_12
DATAF VLV_GRADOSACCEL_12
DATAF VLV_GRADOSCRUCERO_12
DATAF VLV_GRADOSDECEL_12
DATAF VLV_PENDIENTE_12
DATAF VLV_CORRECCION_12
DATAF VLV_STARTB_13
DATAF VLV_STARTC_13
DATAF VLV_ENCODERB_13
DATAF VLV_ENCODERC_13
DATAF VLV_SIGNO_13
DATAF VLV_VEL_13
DATAF VLV_KP_13
DATAF VLV_KD_13
DATAF VLV_ERROR_13
DATAF VLV_OLDERROR_13
DATAF VLV_GRADOSACCEL_13
DATAF VLV_GRADOSCRUCERO_13
DATAF VLV_GRADOSDECEL_13
DATAF VLV_PENDIENTE_13
DATAF VLV_CORRECCION_13
DATAF VLV_SIGNO_14
DATAF VLV_VMIN_14
DATAF VLV_VMAX_14
DATAF VLV_ENCODER_14
DATAF VLV_ENCODER_15
DATAF VLV_LECTURA1_16
DATAF VLV_LECTURA3_16
DATAF VLV_LECTURA4_16
DATAF VLV_KP_16
DATAF VLV_KD_16
DATAF VLV_ERROR_16
DATAF VLV_OLDERROR_16
DATAF VLV_U_16
DATAF VLV_SENTIDO_16
DATAF VLV_LECTURA1_17
DATAF VLV_LECTURA3_17
DATAF VLV_LECTURA4_17
DATAF VLV_KP_17
DATAF VLV_KD_17
DATAF VLV_ERROR_17
DATAF VLV_OLDERROR_17
DATAF VLV_U_17
DATAF VLV_SENTIDO_17
DATAF VLV_STARTC_17
DATAF VLV_ENCODERC_17
DATAF VLV_LECTURA1_18
DATAF VLV_LECTURA3_18
DATAF VLV_LECTURA4_18
DATAF VLV_KP_18
DATAF VLV_KD_18
DATAF VLV_ERROR_18
DATAF VLV_OLDERROR_18
DATAF VLV_U_18
DATAF VLV_SENTIDO_18
DATAF VLV_STARTC_18
DATAF VLV_ENCODERC_18
DATAF VLV_LECTURA1_19
DATAF VLV_LECTURA3_19
DATAF VLV_LECTURA4_19
DATAF VLV_KP_19
DATAF VLV_KD_19
DATAF VLV_ERROR_19
DATAF VLV_OLDERROR_19
DATAF VLV_U_19
DATAF VLV_SENTIDO_19
DATAF VLV_LECTURA_19
DATAF VLV_LECTURAIZQ_19
DATAF VLV_LECTURADCH_19
DATAF VLV_LECTURA1_20
DATAF VLV_LECTURA3_20
DATAF VLV_LECTURA4_20
DATAF VLV_KP_20
DATAF VLV_KD_20
DATAF VLV_ERROR_20
DATAF VLV_OLDERROR_20
DATAF VLV_U_20
DATAF VLV_SENTIDO_20
DATAF VLV_LECTURA_20
DATAF VLV_LECTURAIZQ_20
DATAF VLV_LECTURADCH_20
DATAF VLV_LECTURA1_21
DATAF VLV_LECTURA3_21
DATAF VLV_LECTURA4_21
DATAF VLV_KP_21
DATAF VLV_KD_21
DATAF VLV_ERROR_21
DATAF VLV_OLDERROR_21
DATAF VLV_U_21
DATAF VLV_SENTIDO_21
DATAF VLV_STARTC_21
DATAF VLV_ENCODERC_21
DATAF VLV_SENS_MODE_22
DATAF VLV_RED_22
DATAF VLV_YELLOW_22
DATAF VLV_GREEN_22
DATAF VLV_BLUE_22
DATAF VLV_HUE_22
DATAF VLV_SAT_22
DATAF VLV_VALUE_22
ARRAY16 VLV_RNORMARRAY_22 2
ARRAY16 VLV_GNORMARRAY_22 2
ARRAY16 VLV_BNORMARRAY_22 2
DATAF VLV_J_22
ARRAY16 VLV_RGB_22 2
DATAF VLV_RRAW_22
DATAF VLV_GRAW_22
DATAF VLV_BRAW_22
DATAF VLV_RNORM_22
DATAF VLV_GNORM_22
DATAF VLV_BNORM_22
DATAF VLV_MAX_22
DATAF VLV_MIN_22
DATAF VLV_RGBGREY_22

vmthread MAIN
{
    MOVE32_32 0 STOPLCDUPDATE
    MOVE32_32 0 NUMMAILBOXES
    OUTPUT_RESET 0 15

	WRITE8 0 0 MOTORISINVERTED
	WRITE8 0 1 MOTORISINVERTED
	WRITE8 0 2 MOTORISINVERTED
	WRITE8 0 3 MOTORISINVERTED
	WRITE8 0 0 FIRSTOF2
	WRITE8 0 1 FIRSTOF2
	WRITE8 0 2 FIRSTOF2
	WRITE8 1 3 FIRSTOF2
	WRITE8 0 4 FIRSTOF2
	WRITE8 1 5 FIRSTOF2
	WRITE8 2 6 FIRSTOF2
	WRITE8 0 7 FIRSTOF2
	WRITE8 0 8 FIRSTOF2
	WRITE8 1 9 FIRSTOF2
	WRITE8 2 10 FIRSTOF2
	WRITE8 0 11 FIRSTOF2
	WRITE8 4 12 FIRSTOF2
	WRITE8 0 13 FIRSTOF2
	WRITE8 0 14 FIRSTOF2
	WRITE8 0 15 FIRSTOF2
    INPUT_DEVICE CLR_ALL -1
    ARRAY CREATE8 0 LOCKS
    MOVE32_32 0 s1out1
	MOVE32_32 0 s1out2
	MOVE32_32 0 s1out3
    MOVE32_32 0 s2out1
	MOVE32_32 0 s2out2
	MOVE32_32 0 s2out3
    MOVE32_32 0 s3out1
	MOVE32_32 0 s3out2
	MOVE32_32 0 s3out3
    MOVE32_32 0 s4out1
	MOVE32_32 0 s4out2
	MOVE32_32 0 s4out3
    MOVE32_32 0 timeMC1
	MOVE32_32 0 timeMC2
	MOVE32_32 0 timeMC3
	MOVE32_32 0 timeMC4
	MOVE32_32 0 timeMC5
	MOVE32_32 0 timeMC6
	MOVE32_32 0 timeMC7
	MOVE32_32 0 timeMC8
	MOVE32_32 0 timeMC9
    MOVEF_F 0.0 VPR_GIRO_G1
    MOVEF_F 0.0 VPR_RGB_VALUENEGRO
    MOVEF_F 0.0 VPR_RGB_VALUEBLANCO
    MOVEF_F 0.0 VPR_RGB_RWHITE
    MOVEF_F 0.0 VPR_RGB_GWHITE
    MOVEF_F 0.0 VPR_RGB_BWHITE
    MOVEF_F 0.0 VPR_RECTO_DIAMETRO
    MOVEF_F 0.0 VPR_GIRO_DIAMETRO
    MOVEF_F 0.0 VPR_SIGUELINEAS_DIAMETRO
    MOVEF_F 0.0 VPR_SMART_DIAMETRO
    MOVEF_F 0.0 VPR_SIGUELINEAS_NEGRO1
    MOVEF_F 0.0 VPR_SIGUELINEAS_NEGRO3
    MOVEF_F 0.0 VPR_SIGUELINEAS_NEGRO4
    MOVEF_F 0.0 VPR_SIGUELINEAS_BLANCO1
    MOVEF_F 0.0 VPR_SIGUELINEAS_BLANCO3
    MOVEF_F 0.0 VPR_SIGUELINEAS_BLANCO4
    MOVEF_F 0.0 VPR_SMART_NEGRO1
    MOVEF_F 0.0 VPR_SMART_NEGRO3
    MOVEF_F 0.0 VPR_SMART_NEGRO4
    MOVEF_F 0.0 VPR_SMART_BLANCO1
    MOVEF_F 0.0 VPR_SMART_BLANCO3
    MOVEF_F 0.0 VPR_SMART_BLANCO4
    MOVEF_F 0.0 VPR_RECTO_NEGRO
    MOVEF_F 0.0 VPR_RECTO_BLANCO
    MOVEF_F 0.0 VPR_GIRO_NEGRO
    MOVEF_F 0.0 VPR_GIRO_BLANCO
    MOVEF_F 0.0 VLV_VELOCIDADA_6
    MOVEF_F 0.0 VLV_VELOCIDADD_6
    MOVEF_F 0.0 VLV_TIMER_6
    MOVEF_F 0.0 VLV_VELOCIDAD_8
    MOVEF_F 0.0 VLV_DISTANCIA_8
    MOVEF_F 0.0 VLV_VELOCIDAD1_14
    MOVEF_F 0.0 VLV_VELOCIDAD2_14
    MOVEF_F 0.0 VLV_GRADOS_14
    MOVEF_F 0.0 VLV_VELOCIDAD_9
    MOVEF_F 0.0 VLV_DISTANCIA_9
    MOVEF_F 0.0 VLV_VELOCIDAD_10
    MOVEF_F 0.0 VLV_SENSOR_10
    MOVEF_F 0.0 VLV_VELOCIDAD_16
    MOVEF_F 0.0 VLV_VELOCIDAD_17
    MOVEF_F 0.0 VLV_ENCODER_17
    MOVEF_F 0.0 VLV_SENS_22
    MOVEF_F 0.0 VLV_REPS_22
    MOVEF_F 0.0 VLV_COLOR_22
    MOVEF_F 0.0 VLV_COLOR_23
    MOVEF_F 0.0 VLV_VELOCIDAD_11
    MOVEF_F 0.0 VLV_TIEMPO_11
    MOVEF_F 0.0 VLV_VELOCIDAD_7
    MOVEF_F 0.0 VLV_ENCODER_7
    MOVEF_F 0.0 VLV_VELOCIDAD_18
    MOVEF_F 0.0 VLV_ENCODER_18
    MOVEF_F 0.0 VLV_VELOCIDAD_19
    MOVEF_F 0.0 VLV_READER_19
    MOVEF_F 0.0 VLV_VELOCIDAD1_15
    MOVEF_F 0.0 VLV_VELOCIDAD2_15
    MOVEF_F 0.0 VLV_DISTANCIA_15
    MOVEF_F 0.0 VLV_VELOCIDAD_20
    MOVEF_F 0.0 VLV_READER_20
    MOVEF_F 0.0 VLV_VELOCIDAD_21
    MOVEF_F 0.0 VLV_ENCODER_21
    MOVEF_F 0.0 VLV_V0_12
    MOVEF_F 0.0 VLV_VMAX_12
    MOVEF_F 0.0 VLV_DISTANCIAACCEL_12
    MOVEF_F 0.0 VLV_DISTANCIACRUCERO_12
    MOVEF_F 0.0 VLV_DISTANCIADECEL_12
    MOVEF_F 0.0 VLV_V0_13
    MOVEF_F 0.0 VLV_VMAX_13
    MOVEF_F 0.0 VLV_DISTANCIAACCEL_13
    MOVEF_F 0.0 VLV_DISTANCIACRUCERO_13
    MOVEF_F 0.0 VLV_DISTANCIADECEL_13
    MOVEF_F 0.0 VLV_NUMERO_2
    MOVEF_F 0.0 VGV_MARKINGGRANDE
    MOVEF_F 0.0 VGV_DIAMETRO
    MOVEF_F 0.0 VGV_NEGRO1
    MOVEF_F 0.0 VGV_NEGRO3
    MOVEF_F 0.0 VGV_NEGRO4
    MOVEF_F 0.0 VGV_BLANCO1
    MOVEF_F 0.0 VGV_BLANCO3
    MOVEF_F 0.0 VGV_BLANCO4
    CALL ARRAYCREATE_FLOAT VGV_MARKING
    MOVEF_F 0.0 VLV_VOLTAJE_1
    MOVEF_F 0.0 VLV_ENCDIFF_7
    MOVEF_F 0.0 VLV_SIGNO_7
    MOVEF_F 0.0 VLV_SAFETYTIMER_7
    MOVEF_F 0.0 VLV_CORRECCION_8
    MOVEF_F 0.0 VLV_ENC_8
    MOVEF_F 0.0 VLV_CORRECCION_9
    MOVEF_F 0.0 VLV_ENC_9
    MOVEF_F 0.0 VLV_CORRECCION_10
    MOVEF_F 0.0 VLV_LECTURA_10
    MOVEF_F 0.0 VLV_CORRECCION_11
    MOVEF_F 0.0 VLV_STARTB_12
    MOVEF_F 0.0 VLV_STARTC_12
    MOVEF_F 0.0 VLV_ENCODERB_12
    MOVEF_F 0.0 VLV_ENCODERC_12
    MOVEF_F 0.0 VLV_SIGNO_12
    MOVEF_F 0.0 VLV_VEL_12
    MOVEF_F 0.0 VLV_KP_12
    MOVEF_F 0.0 VLV_KD_12
    MOVEF_F 0.0 VLV_ERROR_12
    MOVEF_F 0.0 VLV_OLDERROR_12
    MOVEF_F 0.0 VLV_GRADOSACCEL_12
    MOVEF_F 0.0 VLV_GRADOSCRUCERO_12
    MOVEF_F 0.0 VLV_GRADOSDECEL_12
    MOVEF_F 0.0 VLV_PENDIENTE_12
    MOVEF_F 0.0 VLV_CORRECCION_12
    MOVEF_F 0.0 VLV_STARTB_13
    MOVEF_F 0.0 VLV_STARTC_13
    MOVEF_F 0.0 VLV_ENCODERB_13
    MOVEF_F 0.0 VLV_ENCODERC_13
    MOVEF_F 0.0 VLV_SIGNO_13
    MOVEF_F 0.0 VLV_VEL_13
    MOVEF_F 0.0 VLV_KP_13
    MOVEF_F 0.0 VLV_KD_13
    MOVEF_F 0.0 VLV_ERROR_13
    MOVEF_F 0.0 VLV_OLDERROR_13
    MOVEF_F 0.0 VLV_GRADOSACCEL_13
    MOVEF_F 0.0 VLV_GRADOSCRUCERO_13
    MOVEF_F 0.0 VLV_GRADOSDECEL_13
    MOVEF_F 0.0 VLV_PENDIENTE_13
    MOVEF_F 0.0 VLV_CORRECCION_13
    MOVEF_F 0.0 VLV_SIGNO_14
    MOVEF_F 0.0 VLV_VMIN_14
    MOVEF_F 0.0 VLV_VMAX_14
    MOVEF_F 0.0 VLV_ENCODER_14
    MOVEF_F 0.0 VLV_ENCODER_15
    MOVEF_F 0.0 VLV_LECTURA1_16
    MOVEF_F 0.0 VLV_LECTURA3_16
    MOVEF_F 0.0 VLV_LECTURA4_16
    MOVEF_F 0.0 VLV_KP_16
    MOVEF_F 0.0 VLV_KD_16
    MOVEF_F 0.0 VLV_ERROR_16
    MOVEF_F 0.0 VLV_OLDERROR_16
    MOVEF_F 0.0 VLV_U_16
    MOVEF_F 0.0 VLV_SENTIDO_16
    MOVEF_F 0.0 VLV_LECTURA1_17
    MOVEF_F 0.0 VLV_LECTURA3_17
    MOVEF_F 0.0 VLV_LECTURA4_17
    MOVEF_F 0.0 VLV_KP_17
    MOVEF_F 0.0 VLV_KD_17
    MOVEF_F 0.0 VLV_ERROR_17
    MOVEF_F 0.0 VLV_OLDERROR_17
    MOVEF_F 0.0 VLV_U_17
    MOVEF_F 0.0 VLV_SENTIDO_17
    MOVEF_F 0.0 VLV_STARTC_17
    MOVEF_F 0.0 VLV_ENCODERC_17
    MOVEF_F 0.0 VLV_LECTURA1_18
    MOVEF_F 0.0 VLV_LECTURA3_18
    MOVEF_F 0.0 VLV_LECTURA4_18
    MOVEF_F 0.0 VLV_KP_18
    MOVEF_F 0.0 VLV_KD_18
    MOVEF_F 0.0 VLV_ERROR_18
    MOVEF_F 0.0 VLV_OLDERROR_18
    MOVEF_F 0.0 VLV_U_18
    MOVEF_F 0.0 VLV_SENTIDO_18
    MOVEF_F 0.0 VLV_STARTC_18
    MOVEF_F 0.0 VLV_ENCODERC_18
    MOVEF_F 0.0 VLV_LECTURA1_19
    MOVEF_F 0.0 VLV_LECTURA3_19
    MOVEF_F 0.0 VLV_LECTURA4_19
    MOVEF_F 0.0 VLV_KP_19
    MOVEF_F 0.0 VLV_KD_19
    MOVEF_F 0.0 VLV_ERROR_19
    MOVEF_F 0.0 VLV_OLDERROR_19
    MOVEF_F 0.0 VLV_U_19
    MOVEF_F 0.0 VLV_SENTIDO_19
    MOVEF_F 0.0 VLV_LECTURA_19
    MOVEF_F 0.0 VLV_LECTURAIZQ_19
    MOVEF_F 0.0 VLV_LECTURADCH_19
    MOVEF_F 0.0 VLV_LECTURA1_20
    MOVEF_F 0.0 VLV_LECTURA3_20
    MOVEF_F 0.0 VLV_LECTURA4_20
    MOVEF_F 0.0 VLV_KP_20
    MOVEF_F 0.0 VLV_KD_20
    MOVEF_F 0.0 VLV_ERROR_20
    MOVEF_F 0.0 VLV_OLDERROR_20
    MOVEF_F 0.0 VLV_U_20
    MOVEF_F 0.0 VLV_SENTIDO_20
    MOVEF_F 0.0 VLV_LECTURA_20
    MOVEF_F 0.0 VLV_LECTURAIZQ_20
    MOVEF_F 0.0 VLV_LECTURADCH_20
    MOVEF_F 0.0 VLV_LECTURA1_21
    MOVEF_F 0.0 VLV_LECTURA3_21
    MOVEF_F 0.0 VLV_LECTURA4_21
    MOVEF_F 0.0 VLV_KP_21
    MOVEF_F 0.0 VLV_KD_21
    MOVEF_F 0.0 VLV_ERROR_21
    MOVEF_F 0.0 VLV_OLDERROR_21
    MOVEF_F 0.0 VLV_U_21
    MOVEF_F 0.0 VLV_SENTIDO_21
    MOVEF_F 0.0 VLV_STARTC_21
    MOVEF_F 0.0 VLV_ENCODERC_21
    MOVEF_F 0.0 VLV_SENS_MODE_22
    MOVEF_F 0.0 VLV_RED_22
    MOVEF_F 0.0 VLV_YELLOW_22
    MOVEF_F 0.0 VLV_GREEN_22
    MOVEF_F 0.0 VLV_BLUE_22
    MOVEF_F 0.0 VLV_HUE_22
    MOVEF_F 0.0 VLV_SAT_22
    MOVEF_F 0.0 VLV_VALUE_22
    CALL ARRAYCREATE_FLOAT VLV_RNORMARRAY_22
    CALL ARRAYCREATE_FLOAT VLV_GNORMARRAY_22
    CALL ARRAYCREATE_FLOAT VLV_BNORMARRAY_22
    MOVEF_F 0.0 VLV_J_22
    CALL ARRAYCREATE_FLOAT VLV_RGB_22
    MOVEF_F 0.0 VLV_RRAW_22
    MOVEF_F 0.0 VLV_GRAW_22
    MOVEF_F 0.0 VLV_BRAW_22
    MOVEF_F 0.0 VLV_RNORM_22
    MOVEF_F 0.0 VLV_GNORM_22
    MOVEF_F 0.0 VLV_BNORM_22
    MOVEF_F 0.0 VLV_MAX_22
    MOVEF_F 0.0 VLV_MIN_22
    MOVEF_F 0.0 VLV_RGBGREY_22
    ARRAY CREATE8 1 LOCKS
    CALL PROGRAM_MAIN -1
    PROGRAM_STOP -1
}
subcall PROGRAM_MAIN
{
    IN_32 SUBPROGRAM
    DATA32 INDEX
    ARRAY8 STACKPOINTER 4
    DATAF F.0
    DATAF F.1
    DATAF F.2
    DATAF F.3
    DATAF F.4
    ARRAY32 RETURNSTACK2 128
    ARRAY32 RETURNSTACK 128
    DATAS S.0 252
    DATAS S.1 252
    MOVE8_8 0 STACKPOINTER
    MOVEF_F 0.0 VPR_GIRO_G1
    MOVEF_F 0.0 VPR_RGB_VALUENEGRO
    MOVEF_F 0.0 VPR_RGB_VALUEBLANCO
    MOVEF_F 0.0 VPR_RGB_RWHITE
    MOVEF_F 0.0 VPR_RGB_GWHITE
    MOVEF_F 0.0 VPR_RGB_BWHITE
    MOVEF_F 0.0 VPR_RECTO_DIAMETRO
    MOVEF_F 0.0 VPR_GIRO_DIAMETRO
    MOVEF_F 0.0 VPR_SIGUELINEAS_DIAMETRO
    MOVEF_F 0.0 VPR_SMART_DIAMETRO
    MOVEF_F 0.0 VPR_SIGUELINEAS_NEGRO1
    MOVEF_F 0.0 VPR_SIGUELINEAS_NEGRO3
    MOVEF_F 0.0 VPR_SIGUELINEAS_NEGRO4
    MOVEF_F 0.0 VPR_SIGUELINEAS_BLANCO1
    MOVEF_F 0.0 VPR_SIGUELINEAS_BLANCO3
    MOVEF_F 0.0 VPR_SIGUELINEAS_BLANCO4
    MOVEF_F 0.0 VPR_SMART_NEGRO1
    MOVEF_F 0.0 VPR_SMART_NEGRO3
    MOVEF_F 0.0 VPR_SMART_NEGRO4
    MOVEF_F 0.0 VPR_SMART_BLANCO1
    MOVEF_F 0.0 VPR_SMART_BLANCO3
    MOVEF_F 0.0 VPR_SMART_BLANCO4
    MOVEF_F 0.0 VPR_RECTO_NEGRO
    MOVEF_F 0.0 VPR_RECTO_BLANCO
    MOVEF_F 0.0 VPR_GIRO_NEGRO
    MOVEF_F 0.0 VPR_GIRO_BLANCO
    MOVEF_F 0.0 VLV_VELOCIDADA_6
    MOVEF_F 0.0 VLV_VELOCIDADD_6
    MOVEF_F 0.0 VLV_TIMER_6
    MOVEF_F 0.0 VLV_VELOCIDAD_8
    MOVEF_F 0.0 VLV_DISTANCIA_8
    MOVEF_F 0.0 VLV_VELOCIDAD1_14
    MOVEF_F 0.0 VLV_VELOCIDAD2_14
    MOVEF_F 0.0 VLV_GRADOS_14
    MOVEF_F 0.0 VLV_VELOCIDAD_9
    MOVEF_F 0.0 VLV_DISTANCIA_9
    MOVEF_F 0.0 VLV_VELOCIDAD_10
    MOVEF_F 0.0 VLV_SENSOR_10
    MOVEF_F 0.0 VLV_VELOCIDAD_16
    MOVEF_F 0.0 VLV_VELOCIDAD_17
    MOVEF_F 0.0 VLV_ENCODER_17
    MOVEF_F 0.0 VLV_SENS_22
    MOVEF_F 0.0 VLV_REPS_22
    MOVEF_F 0.0 VLV_COLOR_22
    MOVEF_F 0.0 VLV_COLOR_23
    MOVEF_F 0.0 VLV_VELOCIDAD_11
    MOVEF_F 0.0 VLV_TIEMPO_11
    MOVEF_F 0.0 VLV_VELOCIDAD_7
    MOVEF_F 0.0 VLV_ENCODER_7
    MOVEF_F 0.0 VLV_VELOCIDAD_18
    MOVEF_F 0.0 VLV_ENCODER_18
    MOVEF_F 0.0 VLV_VELOCIDAD_19
    MOVEF_F 0.0 VLV_READER_19
    MOVEF_F 0.0 VLV_VELOCIDAD1_15
    MOVEF_F 0.0 VLV_VELOCIDAD2_15
    MOVEF_F 0.0 VLV_DISTANCIA_15
    MOVEF_F 0.0 VLV_VELOCIDAD_20
    MOVEF_F 0.0 VLV_READER_20
    MOVEF_F 0.0 VLV_VELOCIDAD_21
    MOVEF_F 0.0 VLV_ENCODER_21
    MOVEF_F 0.0 VLV_V0_12
    MOVEF_F 0.0 VLV_VMAX_12
    MOVEF_F 0.0 VLV_DISTANCIAACCEL_12
    MOVEF_F 0.0 VLV_DISTANCIACRUCERO_12
    MOVEF_F 0.0 VLV_DISTANCIADECEL_12
    MOVEF_F 0.0 VLV_V0_13
    MOVEF_F 0.0 VLV_VMAX_13
    MOVEF_F 0.0 VLV_DISTANCIAACCEL_13
    MOVEF_F 0.0 VLV_DISTANCIACRUCERO_13
    MOVEF_F 0.0 VLV_DISTANCIADECEL_13
    MOVEF_F 0.0 VLV_NUMERO_2
    MOVEF_F 0.0 VGV_MARKINGGRANDE
    MOVEF_F 0.0 VGV_DIAMETRO
    MOVEF_F 0.0 VGV_NEGRO1
    MOVEF_F 0.0 VGV_NEGRO3
    MOVEF_F 0.0 VGV_NEGRO4
    MOVEF_F 0.0 VGV_BLANCO1
    MOVEF_F 0.0 VGV_BLANCO3
    MOVEF_F 0.0 VGV_BLANCO4
    WRITE32 ENDSUB_F_SETUP_0:CALLSUB0 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_SETUP_0
CALLSUB0:
    WRITE32 ENDSUB_F_MAIN_0:CALLSUB1 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_MAIN_0
CALLSUB1:
ENDTHREAD:
    RETURN
SUB_F_SETUP_0:
    DATA8 layer2
	DATA8 no2
	DATA8 mode82
	
	MOVEF_8 1.0 no2
	SUB8 no2 1 no2
	DIV8 no2 4 layer2
	MATH MOD8 no2 4 no2

	MOVEF_8 0.0 mode82
	
	INPUT_DEVICE READY_RAW layer2 no2 0 mode82 0
    DATA8 layer3
	DATA8 no3
	DATA8 mode83
	
	MOVEF_8 2.0 no3
	SUB8 no3 1 no3
	DIV8 no3 4 layer3
	MATH MOD8 no3 4 no3

	MOVEF_8 4.0 mode83
	
	INPUT_DEVICE READY_RAW layer3 no3 0 mode83 0
    DATA8 layer4
	DATA8 no4
	DATA8 mode84
	
	MOVEF_8 3.0 no4
	SUB8 no4 1 no4
	DIV8 no4 4 layer4
	MATH MOD8 no4 4 no4

	MOVEF_8 0.0 mode84
	
	INPUT_DEVICE READY_RAW layer4 no4 0 mode84 0
    DATA8 layer5
	DATA8 no5
	DATA8 mode85
	
	MOVEF_8 4.0 no5
	SUB8 no5 1 no5
	DIV8 no5 4 layer5
	MATH MOD8 no5 4 no5

	MOVEF_8 0.0 mode85
	
	INPUT_DEVICE READY_RAW layer5 no5 0 mode85 0
    MOVEF_F 6.24 VGV_DIAMETRO
    MOVEF_F 2.95833333333333 VPR_GIRO_G1
    MOVEF_F 10.0 VGV_NEGRO1
    MOVEF_F 9.0 VGV_NEGRO3
    MOVEF_F 8.0 VGV_NEGRO4
    MOVEF_F 65.0 VGV_BLANCO1
    MOVEF_F 59.0 VGV_BLANCO3
    MOVEF_F 55.0 VGV_BLANCO4
    MOVEF_F 4.0 VPR_RGB_VALUENEGRO
    MOVEF_F 32.0 VPR_RGB_VALUEBLANCO
    MOVEF_F 57.0 VPR_RGB_RWHITE
    MOVEF_F 71.0 VPR_RGB_GWHITE
    MOVEF_F 73.0 VPR_RGB_BWHITE
    MOVEF_F VGV_DIAMETRO VPR_RECTO_DIAMETRO
    MOVEF_F VGV_DIAMETRO VPR_GIRO_DIAMETRO
    MOVEF_F VGV_DIAMETRO VPR_SIGUELINEAS_DIAMETRO
    MOVEF_F VGV_DIAMETRO VPR_SMART_DIAMETRO
    MOVEF_F VGV_NEGRO1 VPR_SIGUELINEAS_NEGRO1
    MOVEF_F VGV_NEGRO3 VPR_SIGUELINEAS_NEGRO3
    MOVEF_F VGV_NEGRO4 VPR_SIGUELINEAS_NEGRO4
    MOVEF_F VGV_BLANCO1 VPR_SIGUELINEAS_BLANCO1
    MOVEF_F VGV_BLANCO3 VPR_SIGUELINEAS_BLANCO3
    MOVEF_F VGV_BLANCO4 VPR_SIGUELINEAS_BLANCO4
    MOVEF_F VGV_NEGRO1 VPR_SMART_NEGRO1
    MOVEF_F VGV_NEGRO3 VPR_SMART_NEGRO3
    MOVEF_F VGV_NEGRO4 VPR_SMART_NEGRO4
    MOVEF_F VGV_BLANCO1 VPR_SMART_BLANCO1
    MOVEF_F VGV_BLANCO3 VPR_SMART_BLANCO3
    MOVEF_F VGV_BLANCO4 VPR_SMART_BLANCO4
    ADDF VGV_NEGRO1 VGV_NEGRO3 F.1
    ADDF F.1 VGV_NEGRO4 F.0
    DATAF tmpf8
    DATA8 flag8
    DIVF F.0 3.0 tmpf8
    CP_EQF 0.0 3.0 flag8
    SELECTF flag8 0.0 tmpf8 VPR_RECTO_NEGRO

    ADDF VGV_BLANCO1 VGV_BLANCO3 F.1
    ADDF F.1 VGV_BLANCO4 F.0
    DATAF tmpf11
    DATA8 flag11
    DIVF F.0 3.0 tmpf11
    CP_EQF 0.0 3.0 flag11
    SELECTF flag11 0.0 tmpf11 VPR_RECTO_BLANCO

    ADDF VGV_NEGRO1 VGV_NEGRO3 F.1
    ADDF F.1 VGV_NEGRO4 F.0
    DATAF tmpf14
    DATA8 flag14
    DIVF F.0 3.0 tmpf14
    CP_EQF 0.0 3.0 flag14
    SELECTF flag14 0.0 tmpf14 VPR_GIRO_NEGRO

    ADDF VGV_BLANCO1 VGV_BLANCO3 F.1
    ADDF F.1 VGV_BLANCO4 F.0
    DATAF tmpf17
    DATA8 flag17
    DIVF F.0 3.0 tmpf17
    CP_EQF 0.0 3.0 flag17
    SELECTF flag17 0.0 tmpf17 VPR_GIRO_BLANCO

RETSUB_F_SETUP_0:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_F_SETUP_0:
SUB_F_STARTARM_0:
    MOVEF_F 30.0 VLV_VELOCIDADA_6
    MOVEF_F -30.0 VLV_VELOCIDADD_6
    MOVEF_F 250.0 VLV_TIMER_6
    WRITE32 ENDSUB_M_BRAZO_ADTIMER_3:CALLSUB18 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_ADTIMER_3
CALLSUB18:
    OUTPUT_CLR_COUNT 0 1
    OUTPUT_CLR_COUNT 0 8
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Connect'
    SOUND_READY
RETSUB_F_STARTARM_0:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_F_STARTARM_0:
SUB_F_MAIN_0:
    WRITE32 ENDSUB_F_GRITARVOLTAJE_0:CALLSUB23 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_GRITARVOLTAJE_0
CALLSUB23:
    WRITE32 ENDSUB_F_STARTARM_0:CALLSUB24 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_STARTARM_0
CALLSUB24:
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/One'
    WRITE32 ENDSUB_F_S_0:CALLSUB26 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_S_0
CALLSUB26:
    DATA32 milliseconds27
	MOVEF_32 300.0 milliseconds27
	DATA32 timer27
	TIMER_WAIT milliseconds27 timer27
	TIMER_READY timer27
    MOVEF_F 50.0 VLV_VELOCIDAD_8
    MOVEF_F 30.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB28 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB28:
    MOVEF_F 10.0 VLV_VELOCIDAD1_14
    MOVEF_F 40.0 VLV_VELOCIDAD2_14
    MOVEF_F 60.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB29 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB29:
    MOVEF_F 40.0 VLV_VELOCIDAD1_14
    MOVEF_F 10.0 VLV_VELOCIDAD2_14
    MOVEF_F 60.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB30 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB30:
    MOVEF_F 50.0 VLV_VELOCIDAD_9
    MOVEF_F 40.0 VLV_DISTANCIA_9
    WRITE32 ENDSUB_M_RECTO_ENCODERF_2:CALLSUB31 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODERF_2
CALLSUB31:
    MOVEF_F 70.0 VLV_VELOCIDAD_10
    MOVEF_F 4.0 VLV_SENSOR_10
    WRITE32 ENDSUB_M_RECTO_NEGRO1_2:CALLSUB32 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_NEGRO1_2
CALLSUB32:
    MOVEF_F 40.0 VLV_VELOCIDAD1_14
    MOVEF_F -20.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB33 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB33:
    MOVEF_F 60.0 VLV_VELOCIDAD_16
    WRITE32 ENDSUB_M_SIGUELINEAS_CRUCE14_1:CALLSUB34 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_CRUCE14_1
CALLSUB34:
    MOVEF_F 70.0 VLV_VELOCIDAD1_14
    MOVEF_F -62.0 VLV_VELOCIDAD2_14
    MOVEF_F 180.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB35 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB35:
    MOVEF_F 40.0 VLV_VELOCIDAD_17
    MOVEF_F 52.0 VLV_ENCODER_17
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER31_2:CALLSUB36 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER31_2
CALLSUB36:
    MOVEF_F -30.0 VLV_VELOCIDAD1_14
    MOVEF_F 30.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB37 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB37:
    MOVEF_F 60.0 VLV_VELOCIDAD_8
    MOVEF_F 14.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB38 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB38:
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F -30.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB39 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB39:
    MOVEF_F 2.0 VLV_SENS_22
    MOVEF_F 5.0 VLV_REPS_22
    WRITE32 ENDSUB_M_RGB_DETECT_3:CALLSUB40 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_DETECT_3
CALLSUB40:
    MOVEF_F VLV_COLOR_22 VGV_MARKINGGRANDE
    MOVEF_F VGV_MARKINGGRANDE VLV_COLOR_23
    WRITE32 ENDSUB_M_RGB_GRITAR_1:CALLSUB41 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_GRITAR_1
CALLSUB41:
    MOVEF_F 40.0 VLV_VELOCIDAD1_14
    MOVEF_F 10.0 VLV_VELOCIDAD2_14
    MOVEF_F 35.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB42 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB42:
    MOVEF_F 10.0 VLV_VELOCIDAD1_14
    MOVEF_F 40.0 VLV_VELOCIDAD2_14
    MOVEF_F 33.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB43 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB43:
    MOVEF_F 20.0 VLV_VELOCIDAD_8
    MOVEF_F 15.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB44 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB44:
    MOVEF_F 2.0 VLV_SENS_22
    MOVEF_F 5.0 VLV_REPS_22
    WRITE32 ENDSUB_M_RGB_DETECT_3:CALLSUB45 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_DETECT_3
CALLSUB45:
    CALL ARRAYSTORE_FLOAT 0.0 VLV_COLOR_22 VGV_MARKING
    CALL ARRAYGET_FLOAT 0.0 VLV_COLOR_23 VGV_MARKING
    WRITE32 ENDSUB_M_RGB_GRITAR_1:CALLSUB48 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_GRITAR_1
CALLSUB48:
    MOVEF_F 20.0 VLV_VELOCIDAD_11
    MOVEF_F 700.0 VLV_TIEMPO_11
    WRITE32 ENDSUB_M_RECTO_TIEMPO_2:CALLSUB49 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_TIEMPO_2
CALLSUB49:
    MOVEF_F 2.0 VLV_SENS_22
    MOVEF_F 5.0 VLV_REPS_22
    WRITE32 ENDSUB_M_RGB_DETECT_3:CALLSUB50 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_DETECT_3
CALLSUB50:
    CALL ARRAYSTORE_FLOAT 1.0 VLV_COLOR_22 VGV_MARKING
    CALL ARRAYGET_FLOAT 1.0 VLV_COLOR_23 VGV_MARKING
    WRITE32 ENDSUB_M_RGB_GRITAR_1:CALLSUB53 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_GRITAR_1
CALLSUB53:
    MOVEF_F -30.0 VLV_VELOCIDAD_8
    MOVEF_F 35.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB54 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB54:
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F -30.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB55 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB55:
    MOVEF_F 30.0 VLV_VELOCIDAD_8
    MOVEF_F 7.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB56 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB56:
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F -30.0 VLV_VELOCIDAD2_14
    MOVEF_F 85.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB57 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB57:
    MOVEF_F -70.0 VLV_VELOCIDAD_8
    MOVEF_F 30.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB58 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB58:
    MOVEF_F -20.0 VLV_VELOCIDAD_11
    MOVEF_F 500.0 VLV_TIEMPO_11
    WRITE32 ENDSUB_M_RECTO_TIEMPO_2:CALLSUB59 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_TIEMPO_2
CALLSUB59:
    MOVEF_F 20.0 VLV_VELOCIDAD_8
    MOVEF_F 4.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB60 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB60:
    MOVEF_F 2.0 VLV_SENS_22
    MOVEF_F 5.0 VLV_REPS_22
    WRITE32 ENDSUB_M_RGB_DETECT_3:CALLSUB61 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_DETECT_3
CALLSUB61:
    CALL ARRAYSTORE_FLOAT 2.0 VLV_COLOR_22 VGV_MARKING
    CALL ARRAYGET_FLOAT 2.0 VLV_COLOR_23 VGV_MARKING
    WRITE32 ENDSUB_M_RGB_GRITAR_1:CALLSUB64 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_GRITAR_1
CALLSUB64:
    MOVEF_F 20.0 VLV_VELOCIDAD_8
    MOVEF_F 8.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB65 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB65:
    MOVEF_F 2.0 VLV_SENS_22
    MOVEF_F 5.0 VLV_REPS_22
    WRITE32 ENDSUB_M_RGB_DETECT_3:CALLSUB66 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_DETECT_3
CALLSUB66:
    CALL ARRAYSTORE_FLOAT 2.0 VLV_COLOR_22 VGV_MARKING
    CALL ARRAYGET_FLOAT 2.0 VLV_COLOR_23 VGV_MARKING
    WRITE32 ENDSUB_M_RGB_GRITAR_1:CALLSUB69 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RGB_GRITAR_1
CALLSUB69:
    MOVEF_F 70.0 VLV_VELOCIDAD_9
    MOVEF_F 66.0 VLV_DISTANCIA_9
    WRITE32 ENDSUB_M_RECTO_ENCODERF_2:CALLSUB70 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODERF_2
CALLSUB70:
    MOVEF_F -10.0 VLV_VELOCIDAD1_14
    MOVEF_F -50.0 VLV_VELOCIDAD2_14
    MOVEF_F 70.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB71 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB71:
    MOVEF_F -50.0 VLV_VELOCIDAD1_14
    MOVEF_F -10.0 VLV_VELOCIDAD2_14
    MOVEF_F 70.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB72 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB72:
    MOVEF_F 20.0 VLV_VELOCIDAD_7
    MOVEF_F -300.0 VLV_ENCODER_7
    WRITE32 ENDSUB_M_BRAZO_AENCODER_2:CALLSUB73 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_AENCODER_2
CALLSUB73:
    MOVEF_F 20.0 VLV_VELOCIDAD_9
    MOVEF_F 10.0 VLV_DISTANCIA_9
    WRITE32 ENDSUB_M_RECTO_ENCODERF_2:CALLSUB74 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODERF_2
CALLSUB74:
    MOVEF_F 20.0 VLV_VELOCIDAD_11
    MOVEF_F 500.0 VLV_TIEMPO_11
    WRITE32 ENDSUB_M_RECTO_TIEMPO_2:CALLSUB75 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_TIEMPO_2
CALLSUB75:
    MOVEF_F -20.0 VLV_VELOCIDAD_8
    MOVEF_F 5.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB76 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB76:
    MOVEF_F 20.0 VLV_VELOCIDAD_7
    MOVEF_F -50.0 VLV_ENCODER_7
    WRITE32 ENDSUB_M_BRAZO_AENCODER_2:CALLSUB77 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_AENCODER_2
CALLSUB77:
    MOVEF_F 40.0 VLV_VELOCIDAD_8
    MOVEF_F 18.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB78 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB78:
    MOVEF_F 40.0 VLV_VELOCIDAD_10
    MOVEF_F 1.0 VLV_SENSOR_10
    WRITE32 ENDSUB_M_RECTO_NEGRO1_2:CALLSUB79 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_NEGRO1_2
CALLSUB79:
    MOVEF_F -25.0 VLV_VELOCIDAD1_14
    MOVEF_F 40.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB80 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB80:
    MOVEF_F 30.0 VLV_VELOCIDAD_18
    MOVEF_F 10.0 VLV_ENCODER_18
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER14_2:CALLSUB81 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER14_2
CALLSUB81:
    MOVEF_F 25.0 VLV_VELOCIDAD_19
    MOVEF_F 3.0 VLV_READER_19
    WRITE32 ENDSUB_M_SIGUELINEAS_CRUCE_EXTERNO_2:CALLSUB82 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_CRUCE_EXTERNO_2
CALLSUB82:
    MOVEF_F -30.0 VLV_VELOCIDAD1_14
    MOVEF_F 30.0 VLV_VELOCIDAD2_14
    MOVEF_F 178.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB83 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB83:
    MOVEF_F -10.0 VLV_VELOCIDAD_8
    MOVEF_F 20.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB84 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB84:
    MOVEF_F 10.0 VLV_VELOCIDAD_8
    MOVEF_F 1.5 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB85 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB85:
    WRITE32 ENDSUB_F_BAJARARANA_0:CALLSUB86 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_BAJARARANA_0
CALLSUB86:
    DATA32 milliseconds87
	MOVEF_32 400.0 milliseconds87
	DATA32 timer87
	TIMER_WAIT milliseconds87 timer87
	TIMER_READY timer87
    MOVEF_F 10.0 VLV_VELOCIDAD_8
    MOVEF_F 3.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB88 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB88:
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F 0.0 VLV_VELOCIDAD2_14
    MOVEF_F 30.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB89 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB89:
    MOVEF_F 20.0 VLV_VELOCIDAD_8
    MOVEF_F 15.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB90 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB90:
    MOVEF_F 15.0 VLV_VELOCIDAD1_14
    MOVEF_F -15.0 VLV_VELOCIDAD2_14
    MOVEF_F 75.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB91 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB91:
    MOVEF_F 30.0 VLV_VELOCIDAD_10
    MOVEF_F 1.0 VLV_SENSOR_10
    WRITE32 ENDSUB_M_RECTO_NEGRO1_2:CALLSUB92 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_NEGRO1_2
CALLSUB92:
    MOVEF_F 30.0 VLV_VELOCIDAD_18
    MOVEF_F 35.0 VLV_ENCODER_18
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER14_2:CALLSUB93 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER14_2
CALLSUB93:
    MOVEF_F 40.0 VLV_VELOCIDAD_8
    MOVEF_F 14.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB94 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB94:
    MOVEF_F -30.0 VLV_VELOCIDAD1_14
    MOVEF_F 0.0 VLV_VELOCIDAD2_14
    MOVEF_F -45.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB95 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB95:
    MOVEF_F -20.0 VLV_VELOCIDAD_8
    MOVEF_F 13.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB96 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB96:
    MOVEF_F 30.0 VLV_VELOCIDAD_7
    MOVEF_F -50.0 VLV_ENCODER_7
    WRITE32 ENDSUB_M_BRAZO_AENCODER_2:CALLSUB97 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_AENCODER_2
CALLSUB97:
    MOVEF_F 10.0 VLV_VELOCIDAD_8
    MOVEF_F 6.5 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB98 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB98:
    WRITE32 ENDSUB_F_BAJARARANA_0:CALLSUB99 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_BAJARARANA_0
CALLSUB99:
    DATA32 milliseconds100
	MOVEF_32 400.0 milliseconds100
	DATA32 timer100
	TIMER_WAIT milliseconds100 timer100
	TIMER_READY timer100
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F 0.0 VLV_VELOCIDAD2_14
    MOVEF_F 45.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB101 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB101:
    MOVEF_F -30.0 VLV_VELOCIDAD_8
    MOVEF_F 4.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB102 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB102:
    MOVEF_F -15.0 VLV_VELOCIDAD1_14
    MOVEF_F 15.0 VLV_VELOCIDAD2_14
    MOVEF_F 124.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB103 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB103:
    MOVEF_F -30.0 VLV_VELOCIDAD_8
    MOVEF_F 13.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB104 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB104:
    MOVEF_F 30.0 VLV_VELOCIDAD_7
    MOVEF_F -50.0 VLV_ENCODER_7
    WRITE32 ENDSUB_M_BRAZO_AENCODER_2:CALLSUB105 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_AENCODER_2
CALLSUB105:
    MOVEF_F -20.0 VLV_VELOCIDAD1_14
    MOVEF_F 20.0 VLV_VELOCIDAD2_14
    MOVEF_F 10.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB106 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB106:
    MOVEF_F 60.0 VLV_VELOCIDAD1_15
    MOVEF_F 70.0 VLV_VELOCIDAD2_15
    MOVEF_F 73.0 VLV_DISTANCIA_15
    WRITE32 ENDSUB_M_GIRO_ENCODER_3:CALLSUB107 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_ENCODER_3
CALLSUB107:
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F -30.0 VLV_VELOCIDAD2_14
    MOVEF_F 72.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB108 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB108:
    MOVEF_F 40.0 VLV_VELOCIDAD_20
    MOVEF_F 4.0 VLV_READER_20
    WRITE32 ENDSUB_M_SIGUELINEAS_CRUCE_EXTERNOF_2:CALLSUB109 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_CRUCE_EXTERNOF_2
CALLSUB109:
    MOVEF_F 80.0 VLV_VELOCIDAD_21
    MOVEF_F 50.0 VLV_ENCODER_21
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER31F_2:CALLSUB110 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER31F_2
CALLSUB110:
    JR_NEQF VGV_MARKINGGRANDE 2.0 else111_1
    MOVEF_F 80.0 VLV_VELOCIDAD_21
    MOVEF_F 40.0 VLV_ENCODER_21
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER31F_2:CALLSUB112 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER31F_2
CALLSUB112:
    MOVEF_F 30.0 VLV_VELOCIDAD_17
    MOVEF_F 9.0 VLV_ENCODER_17
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER31_2:CALLSUB113 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER31_2
CALLSUB113:
    MOVEF_F 30.0 VLV_VELOCIDAD_8
    MOVEF_F 16.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB114 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB114:
    MOVEF_F -20.0 VLV_VELOCIDAD1_14
    MOVEF_F 20.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB115 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB115:
    MOVEF_F -10.0 VLV_VELOCIDAD_8
    MOVEF_F 8.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB116 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB116:
    WRITE32 ENDSUB_F_BAJARARANA_0:CALLSUB117 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_BAJARARANA_0
CALLSUB117:
    MOVEF_F -20.0 VLV_VELOCIDAD1_14
    MOVEF_F -40.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB118 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB118:
    MOVEF_F -30.0 VLV_V0_12
    MOVEF_F -80.0 VLV_VMAX_12
    MOVEF_F 10.0 VLV_DISTANCIAACCEL_12
    MOVEF_F 1.0 VLV_DISTANCIACRUCERO_12
    MOVEF_F 15.0 VLV_DISTANCIADECEL_12
    WRITE32 ENDSUB_M_RECTO_ACCELDECELF_5:CALLSUB119 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ACCELDECELF_5
CALLSUB119:
    MOVEF_F -10.0 VLV_VELOCIDAD_8
    MOVEF_F 5.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB120 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB120:
    MOVEF_F 10.0 VLV_VELOCIDAD_8
    MOVEF_F 2.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB121 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB121:
    MOVEF_F 40.0 VLV_VELOCIDAD_7
    MOVEF_F -50.0 VLV_ENCODER_7
    WRITE32 ENDSUB_M_BRAZO_AENCODER_2:CALLSUB122 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_AENCODER_2
CALLSUB122:
    JR endif111
  else111_1:
    JR_NEQF VGV_MARKINGGRANDE 5.0 else111_2
    MOVEF_F 30.0 VLV_VELOCIDAD_17
    MOVEF_F 10.0 VLV_ENCODER_17
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER31_2:CALLSUB123 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER31_2
CALLSUB123:
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F -30.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB124 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB124:
    MOVEF_F 40.0 VLV_VELOCIDAD_8
    MOVEF_F 26.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB125 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB125:
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F -30.0 VLV_VELOCIDAD2_14
    MOVEF_F 88.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB126 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB126:
    MOVEF_F -60.0 VLV_VELOCIDAD_9
    MOVEF_F 27.0 VLV_DISTANCIA_9
    WRITE32 ENDSUB_M_RECTO_ENCODERF_2:CALLSUB127 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODERF_2
CALLSUB127:
    MOVEF_F -20.0 VLV_VELOCIDAD_8
    MOVEF_F 10.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB128 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB128:
    WRITE32 ENDSUB_F_BAJARARANA_0:CALLSUB129 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_BAJARARANA_0
CALLSUB129:
    MOVEF_F -5.0 VLV_VELOCIDAD1_14
    MOVEF_F -60.0 VLV_VELOCIDAD2_14
    MOVEF_F 182.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB130 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB130:
    MOVEF_F -80.0 VLV_VELOCIDAD_9
    MOVEF_F 37.0 VLV_DISTANCIA_9
    WRITE32 ENDSUB_M_RECTO_ENCODERF_2:CALLSUB131 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODERF_2
CALLSUB131:
    MOVEF_F -10.0 VLV_VELOCIDAD_8
    MOVEF_F 6.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB132 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB132:
    MOVEF_F 10.0 VLV_VELOCIDAD_8
    MOVEF_F 2.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB133 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB133:
    MOVEF_F 40.0 VLV_VELOCIDAD_7
    MOVEF_F -60.0 VLV_ENCODER_7
    WRITE32 ENDSUB_M_BRAZO_AENCODER_2:CALLSUB134 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_AENCODER_2
CALLSUB134:
    JR endif111
  else111_2:
    JR_NEQF VGV_MARKINGGRANDE 4.0 else111_3
    MOVEF_F 80.0 VLV_VELOCIDAD_21
    MOVEF_F 34.5 VLV_ENCODER_21
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER31F_2:CALLSUB135 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER31F_2
CALLSUB135:
    MOVEF_F 30.0 VLV_VELOCIDAD_17
    MOVEF_F 9.0 VLV_ENCODER_17
    WRITE32 ENDSUB_M_SIGUELINEAS_ENCODER31_2:CALLSUB136 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_ENCODER31_2
CALLSUB136:
    MOVEF_F 30.0 VLV_VELOCIDAD1_14
    MOVEF_F -30.0 VLV_VELOCIDAD2_14
    MOVEF_F 90.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB137 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB137:
    MOVEF_F 30.0 VLV_V0_13
    MOVEF_F 80.0 VLV_VMAX_13
    MOVEF_F 10.0 VLV_DISTANCIAACCEL_13
    MOVEF_F 30.5 VLV_DISTANCIACRUCERO_13
    MOVEF_F 10.0 VLV_DISTANCIADECEL_13
    WRITE32 ENDSUB_M_RECTO_ACCELDECEL_5:CALLSUB138 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ACCELDECEL_5
CALLSUB138:
    MOVEF_F -30.0 VLV_VELOCIDAD1_14
    MOVEF_F 30.0 VLV_VELOCIDAD2_14
    MOVEF_F 86.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB139 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB139:
    MOVEF_F 20.0 VLV_VELOCIDAD_9
    MOVEF_F 5.0 VLV_DISTANCIA_9
    WRITE32 ENDSUB_M_RECTO_ENCODERF_2:CALLSUB140 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODERF_2
CALLSUB140:
    MOVEF_F 20.0 VLV_VELOCIDAD_19
    MOVEF_F 4.0 VLV_READER_19
    WRITE32 ENDSUB_M_SIGUELINEAS_CRUCE_EXTERNO_2:CALLSUB141 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_SIGUELINEAS_CRUCE_EXTERNO_2
CALLSUB141:
    MOVEF_F -10.0 VLV_VELOCIDAD_8
    MOVEF_F 1.5 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB142 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB142:
    MOVEF_F 15.0 VLV_VELOCIDAD1_14
    MOVEF_F -30.0 VLV_VELOCIDAD2_14
    MOVEF_F 87.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB143 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB143:
    MOVEF_F -10.0 VLV_VELOCIDAD_8
    MOVEF_F 5.5 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB144 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB144:
    WRITE32 ENDSUB_F_BAJARARANA_0:CALLSUB145 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_BAJARARANA_0
CALLSUB145:
    MOVEF_F 10.0 VLV_VELOCIDAD_8
    MOVEF_F 0.5 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB146 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB146:
    DATA32 milliseconds147
	MOVEF_32 100.0 milliseconds147
	DATA32 timer147
	TIMER_WAIT milliseconds147 timer147
	TIMER_READY timer147
    MOVEF_F -30.0 VLV_VELOCIDAD1_14
    MOVEF_F 30.0 VLV_VELOCIDAD2_14
    MOVEF_F 87.0 VLV_GRADOS_14
    WRITE32 ENDSUB_M_GIRO_GRADOS_3:CALLSUB148 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_GIRO_GRADOS_3
CALLSUB148:
    MOVEF_F -80.0 VLV_VELOCIDAD_8
    MOVEF_F 54.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB149 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB149:
    MOVEF_F -20.0 VLV_VELOCIDAD_8
    MOVEF_F 7.0 VLV_DISTANCIA_8
    WRITE32 ENDSUB_M_RECTO_ENCODER_2:CALLSUB150 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_RECTO_ENCODER_2
CALLSUB150:
    MOVEF_F 40.0 VLV_VELOCIDAD_7
    MOVEF_F -50.0 VLV_ENCODER_7
    WRITE32 ENDSUB_M_BRAZO_AENCODER_2:CALLSUB151 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_AENCODER_2
CALLSUB151:
  else111_3:
  endif111:
RETSUB_F_MAIN_0:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_F_MAIN_0:
SUB_F_GRITARVOLTAJE_0:
    CALL EV3.BATTERYVOLTAGE VLV_VOLTAJE_1
    MATH FLOOR VLV_VOLTAJE_1 VLV_NUMERO_2
    WRITE32 ENDSUB_F_GRITARNUMERO_1:CALLSUB154 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_GRITARNUMERO_1
CALLSUB154:
    MULF VLV_VOLTAJE_1 10.0 F.1
    MATH FLOOR F.1 F.0
    MATH FLOOR VLV_VOLTAJE_1 F.2
    MULF F.2 10.0 F.1
    SUBF F.0 F.1 VLV_NUMERO_2
    WRITE32 ENDSUB_F_GRITARNUMERO_1:CALLSUB160 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_GRITARNUMERO_1
CALLSUB160:
    MULF VLV_VOLTAJE_1 100.0 F.1
    MATH FLOOR F.1 F.0
    MULF VLV_VOLTAJE_1 10.0 F.3
    MATH FLOOR F.3 F.2
    MULF F.2 10.0 F.1
    SUBF F.0 F.1 VLV_NUMERO_2
    WRITE32 ENDSUB_F_GRITARNUMERO_1:CALLSUB167 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_F_GRITARNUMERO_1
CALLSUB167:
RETSUB_F_GRITARVOLTAJE_0:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_F_GRITARVOLTAJE_0:
SUB_F_GRITARNUMERO_1:
    JR_NEQF VLV_NUMERO_2 0.0 else168_1
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/ZERO'
    JR endif168
  else168_1:
    JR_NEQF VLV_NUMERO_2 1.0 else168_2
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/One'
    JR endif168
  else168_2:
    JR_NEQF VLV_NUMERO_2 2.0 else168_3
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Two'
    JR endif168
  else168_3:
    JR_NEQF VLV_NUMERO_2 3.0 else168_4
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Three'
    JR endif168
  else168_4:
    JR_NEQF VLV_NUMERO_2 4.0 else168_5
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Four'
    JR endif168
  else168_5:
    JR_NEQF VLV_NUMERO_2 5.0 else168_6
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Five'
    JR endif168
  else168_6:
    JR_NEQF VLV_NUMERO_2 6.0 else168_7
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Six'
    JR endif168
  else168_7:
    JR_NEQF VLV_NUMERO_2 7.0 else168_8
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Seven'
    JR endif168
  else168_8:
    JR_NEQF VLV_NUMERO_2 8.0 else168_9
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Eight'
    JR endif168
  else168_9:
    JR_NEQF VLV_NUMERO_2 9.0 else168_10
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Nine'
    JR endif168
  else168_10:
    JR_NEQF VLV_NUMERO_2 10.0 else168_11
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Ten'
  else168_11:
  endif168:
    SOUND_READY
RETSUB_F_GRITARNUMERO_1:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_F_GRITARNUMERO_1:
SUB_F_BAJARARANA_0:
    MOVEF_F 20.0 VLV_VELOCIDAD_7
    MOVEF_F -370.0 VLV_ENCODER_7
    WRITE32 ENDSUB_M_BRAZO_AENCODER_2:CALLSUB181 STACKPOINTER RETURNSTACK
    ADD8 STACKPOINTER 1 STACKPOINTER
    JR SUB_M_BRAZO_AENCODER_2
CALLSUB181:
RETSUB_F_BAJARARANA_0:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_F_BAJARARANA_0:
SUB_F_S_0:
    UI_BUTTON FLUSH
    UI_BUTTON WAIT_FOR_PRESS
RETSUB_F_S_0:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_F_S_0:
SUB_M_BRAZO_ADTIMER_3:
    TIMER_READ timeMC1
  while185:
    TIMER_READ timeMC1tmp
	SUB32 timeMC1tmp timeMC1 timeMC1tmp
	MOVE32_F timeMC1tmp F.0
    JR_GTEQF F.0 VLV_TIMER_6 endwhile185
  whilebody185:
    MOVEF_8 VLV_VELOCIDADA_6 setSpeedA
	OUTPUT_SPEED 0 1 setSpeedA
	OUTPUT_START 0 1
    MOVEF_8 VLV_VELOCIDADD_6 setSpeedD
	OUTPUT_SPEED 0 8 setSpeedD
	OUTPUT_START 0 8
    TIMER_READ timeMC1tmp
	SUB32 timeMC1tmp timeMC1 timeMC1tmp
	MOVE32_F timeMC1tmp F.0
    JR_LTF F.0 VLV_TIMER_6 whilebody185
  endwhile185:
    CALL MOTOR.STOP 'AD' 'True'
RETSUB_M_BRAZO_ADTIMER_3:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_BRAZO_ADTIMER_3:
SUB_M_BRAZO_AENCODER_2:
    CALL MOTOR.GETCOUNT 'A' F.0
    SUBF VLV_ENCODER_7 F.0 VLV_ENCDIFF_7
    MATH ABS VLV_ENCDIFF_7 F.0
    DATAF tmpf194
    DATA8 flag194
    DIVF VLV_ENCDIFF_7 F.0 tmpf194
    CP_EQF 0.0 F.0 flag194
    SELECTF flag194 0.0 tmpf194 VLV_SIGNO_7

    MATH ABS VLV_ENCDIFF_7 F.4
    DATAF tmpf196
    DATA8 flag196
    DIVF F.4 100.0 tmpf196
    CP_EQF 0.0 100.0 flag196
    SELECTF flag196 0.0 tmpf196 F.3

    DATAF tmpf197
    DATA8 flag197
    DIVF VLV_VELOCIDAD_7 20.0 tmpf197
    CP_EQF 0.0 20.0 flag197
    SELECTF flag197 0.0 tmpf197 F.4

    DATAF tmpf198
    DATA8 flag198
    DIVF F.3 F.4 tmpf198
    CP_EQF 0.0 F.4 flag198
    SELECTF flag198 0.0 tmpf198 F.2

    MULF F.2 650.0 F.1
    MULF F.1 2.0 F.0
    DATA8 flag201
	CP_GTF F.0 400.0 flag201
	SELECTF flag201 F.0 400.0 VLV_SAFETYTIMER_7
    TIMER_READ timeMC3
    JR_EQF VLV_ENCDIFF_7 0.0 else203_1
  while204:
    CALL MOTOR.GETCOUNT 'A' F.2
    SUBF F.2 VLV_ENCODER_7 F.1
    MATH ABS F.1 F.0
    JR_LTEQF F.0 25.0 endwhile204
    TIMER_READ timeMC3tmp
	SUB32 timeMC3tmp timeMC3 timeMC3tmp
	MOVE32_F timeMC3tmp F.0
    JR_GTEQF F.0 2000.0 endwhile204
  whilebody204:
    MULF VLV_SIGNO_7 VLV_VELOCIDAD_7 F.0
    MOVEF_8 F.0 setSpeedA
	OUTPUT_SPEED 0 1 setSpeedA
	OUTPUT_START 0 1
    CALL MOTOR.GETCOUNT 'A' F.2
    SUBF F.2 VLV_ENCODER_7 F.1
    MATH ABS F.1 F.0
    JR_LTEQF F.0 25.0 and211
    TIMER_READ timeMC3tmp
	SUB32 timeMC3tmp timeMC3 timeMC3tmp
	MOVE32_F timeMC3tmp F.0
    JR_LTF F.0 2000.0 whilebody204
  and211:
  endwhile204:
    CALL MOTOR.STOP 'A' 'True'
  else203_1:
  endif203:
RETSUB_M_BRAZO_AENCODER_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_BRAZO_AENCODER_2:
SUB_M_RECTO_ENCODER_2:
    MATH ABS VLV_VELOCIDAD_8 F.1
    SUBF F.1 20.0 F.0
    MULF F.0 0.05 VLV_CORRECCION_8
    SUBF VLV_DISTANCIA_8 VLV_CORRECCION_8 F.2
    MULF F.2 360.0 F.1
    MOVEF_F 3.1415926535897932384 F.2
    DATAF tmpf223
    DATA8 flag223
    DIVF F.1 F.2 tmpf223
    CP_EQF 0.0 F.2 flag223
    SELECTF flag223 0.0 tmpf223 F.0

    DATAF tmpf224
    DATA8 flag224
    DIVF F.0 VPR_RECTO_DIAMETRO tmpf224
    CP_EQF 0.0 VPR_RECTO_DIAMETRO flag224
    SELECTF flag224 0.0 tmpf224 VLV_ENC_8

    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
    DATA32 milliseconds226
	MOVEF_32 100.0 milliseconds226
	DATA32 timer226
	TIMER_WAIT milliseconds226 timer226
	TIMER_READY timer226
    MATH NEGATE VLV_VELOCIDAD_8 F.0
    CALL MOTOR.SCHEDULESYNC 'BC' F.0 VLV_VELOCIDAD_8 VLV_ENC_8 'True'

	DATA8 layer228
	DATA8 nos228
	DATA8 busy228
	CALL MOTORDECODEPORTSDESCRIPTOR 'BC' layer228 nos228
	JR_EQ8 0 nos228 motornotbusy228
  motorwaiting228:
	OUTPUT_TEST layer228 nos228 busy228
	JR_EQ8 busy228 0 motornotbusy228
	SLEEP
	JR motorwaiting228
  motornotbusy228:
RETSUB_M_RECTO_ENCODER_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_RECTO_ENCODER_2:
SUB_M_RECTO_ENCODERF_2:
    MATH ABS VLV_VELOCIDAD_9 F.1
    SUBF F.1 20.0 F.0
    MULF F.0 0.05 VLV_CORRECCION_9
    SUBF VLV_DISTANCIA_9 VLV_CORRECCION_9 F.2
    MULF F.2 360.0 F.1
    MOVEF_F 3.1415926535897932384 F.2
    DATAF tmpf235
    DATA8 flag235
    DIVF F.1 F.2 tmpf235
    CP_EQF 0.0 F.2 flag235
    SELECTF flag235 0.0 tmpf235 F.0

    DATAF tmpf236
    DATA8 flag236
    DIVF F.0 VPR_RECTO_DIAMETRO tmpf236
    CP_EQF 0.0 VPR_RECTO_DIAMETRO flag236
    SELECTF flag236 0.0 tmpf236 VLV_ENC_9

    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
    DATA32 milliseconds238
	MOVEF_32 100.0 milliseconds238
	DATA32 timer238
	TIMER_WAIT milliseconds238 timer238
	TIMER_READY timer238
    MATH NEGATE VLV_VELOCIDAD_9 F.0
    CALL MOTOR.SCHEDULESYNC 'BC' F.0 VLV_VELOCIDAD_9 VLV_ENC_9 'False'

	DATA8 layer240
	DATA8 nos240
	DATA8 busy240
	CALL MOTORDECODEPORTSDESCRIPTOR 'BC' layer240 nos240
	JR_EQ8 0 nos240 motornotbusy240
  motorwaiting240:
	OUTPUT_TEST layer240 nos240 busy240
	JR_EQ8 busy240 0 motornotbusy240
	SLEEP
	JR motorwaiting240
  motornotbusy240:
RETSUB_M_RECTO_ENCODERF_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_RECTO_ENCODERF_2:
SUB_M_RECTO_NEGRO1_2:
    MOVEF_F 0.0 VLV_CORRECCION_10
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
    MOVEF_F 50.0 VLV_LECTURA_10
  while242:
    JR_LTEQF VLV_LECTURA_10 15.0 endwhile242
  whilebody242:
    CALL SENSOR.READPERCENT VLV_SENSOR_10 F.2
    SUBF F.2 VPR_RECTO_NEGRO F.1
    DATAF tmpf245
    DATA8 flag245
    DIVF F.1 VPR_RECTO_BLANCO tmpf245
    CP_EQF 0.0 VPR_RECTO_BLANCO flag245
    SELECTF flag245 0.0 tmpf245 F.0

    SUBF 100.0 VPR_RECTO_NEGRO F.1
    MULF F.0 F.1 VLV_LECTURA_10
    MATH NEGATE VLV_VELOCIDAD_10 F.1
    ADDF F.1 VLV_CORRECCION_10 F.0
    ADDF VLV_VELOCIDAD_10 VLV_CORRECCION_10 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    JR_GTF VLV_LECTURA_10 15.0 whilebody242
  endwhile242:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 1
RETSUB_M_RECTO_NEGRO1_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_RECTO_NEGRO1_2:
SUB_M_RECTO_TIEMPO_2:
    MOVEF_F 0.0 VLV_CORRECCION_11
    TIMER_READ timeMC3
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
  while255:
    TIMER_READ timeMC3tmp
	SUB32 timeMC3tmp timeMC3 timeMC3tmp
	MOVE32_F timeMC3tmp F.0
    JR_GTEQF F.0 VLV_TIEMPO_11 endwhile255
  whilebody255:
    MATH NEGATE VLV_VELOCIDAD_11 F.1
    ADDF F.1 VLV_CORRECCION_11 F.0
    ADDF VLV_VELOCIDAD_11 VLV_CORRECCION_11 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    TIMER_READ timeMC3tmp
	SUB32 timeMC3tmp timeMC3 timeMC3tmp
	MOVE32_F timeMC3tmp F.0
    JR_LTF F.0 VLV_TIEMPO_11 whilebody255
  endwhile255:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 1
RETSUB_M_RECTO_TIEMPO_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_RECTO_TIEMPO_2:
SUB_M_RECTO_ACCELDECELF_5:
    CALL MOTOR.GETCOUNT 'B' VLV_STARTB_12
    CALL MOTOR.GETCOUNT 'C' VLV_STARTC_12
    MOVEF_F 0.0 VLV_ENCODERB_12
    MOVEF_F 0.0 VLV_ENCODERC_12
    MATH ABS VLV_V0_12 F.0
    DATAF tmpf266
    DATA8 flag266
    DIVF VLV_V0_12 F.0 tmpf266
    CP_EQF 0.0 F.0 flag266
    SELECTF flag266 0.0 tmpf266 VLV_SIGNO_12

    MATH ABS VLV_V0_12 F.1
    DATA8 flag268
	CP_GTF 8.0 F.1 flag268
	SELECTF flag268 8.0 F.1 F.0
    MULF F.0 VLV_SIGNO_12 VLV_V0_12
    MATH ABS VLV_VMAX_12 F.1
    DATA8 flag271
	CP_LTF 90.0 F.1 flag271
	SELECTF flag271 90.0 F.1 F.0
    MULF F.0 VLV_SIGNO_12 VLV_VMAX_12
    MOVEF_F 0.0 VLV_VEL_12
    MOVEF_F 0.4 VLV_KP_12
    MOVEF_F 0.5 VLV_KD_12
    MOVEF_F 0.0 VLV_ERROR_12
    MOVEF_F 0.0 VLV_OLDERROR_12
    MULF VLV_DISTANCIAACCEL_12 360.0 F.0
    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_RECTO_DIAMETRO F.2 F.1
    DATAF tmpf276
    DATA8 flag276
    DIVF F.0 F.1 tmpf276
    CP_EQF 0.0 F.1 flag276
    SELECTF flag276 0.0 tmpf276 VLV_GRADOSACCEL_12

    MULF VLV_DISTANCIACRUCERO_12 360.0 F.0
    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_RECTO_DIAMETRO F.2 F.1
    DATAF tmpf280
    DATA8 flag280
    DIVF F.0 F.1 tmpf280
    CP_EQF 0.0 F.1 flag280
    SELECTF flag280 0.0 tmpf280 VLV_GRADOSCRUCERO_12

    MULF VLV_DISTANCIADECEL_12 360.0 F.0
    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_RECTO_DIAMETRO F.2 F.1
    DATAF tmpf284
    DATA8 flag284
    DIVF F.0 F.1 tmpf284
    CP_EQF 0.0 F.1 flag284
    SELECTF flag284 0.0 tmpf284 VLV_GRADOSDECEL_12

  while285:
    MATH ABS VLV_ENCODERC_12 F.0
    ADDF VLV_GRADOSACCEL_12 VLV_GRADOSCRUCERO_12 F.2
    ADDF F.2 VLV_GRADOSDECEL_12 F.1
    JR_GTEQF F.0 F.1 endwhile285
  whilebody285:
    CALL MOTOR.GETCOUNT 'B' F.1
    MULF F.1 1.0 F.0
    SUBF F.0 VLV_STARTB_12 VLV_ENCODERB_12
    CALL MOTOR.GETCOUNT 'C' F.0
    SUBF F.0 VLV_STARTC_12 VLV_ENCODERC_12
    MATH ABS VLV_ENCODERC_12 F.0
    ADDF VLV_GRADOSACCEL_12 VLV_GRADOSCRUCERO_12 F.1
    JR_GTEQF F.0 F.1 else294_1
    SUBF VLV_VMAX_12 VLV_V0_12 F.1
    DATAF tmpf298
    DATA8 flag298
    DIVF F.1 VLV_GRADOSACCEL_12 tmpf298
    CP_EQF 0.0 VLV_GRADOSACCEL_12 flag298
    SELECTF flag298 0.0 tmpf298 F.0

    MULF F.0 VLV_SIGNO_12 VLV_PENDIENTE_12
    JR_LTEQF VLV_SIGNO_12 0.0 else300_1
    MULF VLV_PENDIENTE_12 VLV_ENCODERC_12 F.1
    ADDF F.1 VLV_V0_12 F.0
    DATA8 flag303
	CP_LTF VLV_VMAX_12 F.0 flag303
	SELECTF flag303 VLV_VMAX_12 F.0 VLV_VEL_12
    JR endif300
  else300_1:
    MULF VLV_PENDIENTE_12 VLV_ENCODERC_12 F.1
    ADDF F.1 VLV_V0_12 F.0
    DATA8 flag306
	CP_GTF VLV_VMAX_12 F.0 flag306
	SELECTF flag306 VLV_VMAX_12 F.0 VLV_VEL_12
  else300_2:
  endif300:
    JR endif294
  else294_1:
    SUBF VLV_V0_12 VLV_VMAX_12 F.1
    DATAF tmpf308
    DATA8 flag308
    DIVF F.1 VLV_GRADOSDECEL_12 tmpf308
    CP_EQF 0.0 VLV_GRADOSDECEL_12 flag308
    SELECTF flag308 0.0 tmpf308 F.0

    MULF F.0 VLV_SIGNO_12 VLV_PENDIENTE_12
    JR_LTEQF VLV_SIGNO_12 0.0 else310_1
    SUBF VLV_ENCODERC_12 VLV_GRADOSACCEL_12 F.3
    SUBF F.3 VLV_GRADOSCRUCERO_12 F.2
    MULF VLV_PENDIENTE_12 F.2 F.1
    ADDF F.1 VLV_VMAX_12 F.0
    DATA8 flag315
	CP_GTF VLV_V0_12 F.0 flag315
	SELECTF flag315 VLV_V0_12 F.0 VLV_VEL_12
    JR endif310
  else310_1:
    ADDF VLV_ENCODERC_12 VLV_GRADOSACCEL_12 F.3
    ADDF F.3 VLV_GRADOSCRUCERO_12 F.2
    MULF VLV_PENDIENTE_12 F.2 F.1
    ADDF F.1 VLV_VMAX_12 F.0
    DATA8 flag320
	CP_LTF VLV_V0_12 F.0 flag320
	SELECTF flag320 VLV_V0_12 F.0 VLV_VEL_12
  else310_2:
  endif310:
  else294_2:
  endif294:
    MULF -1.0 VLV_ENCODERB_12 F.1
    SUBF F.1 VLV_ENCODERC_12 F.0
    MULF F.0 1.0 VLV_ERROR_12
    MULF VLV_ERROR_12 VLV_KP_12 F.0
    SUBF VLV_ERROR_12 VLV_OLDERROR_12 F.2
    MULF F.2 VLV_KD_12 F.1
    ADDF F.0 F.1 VLV_CORRECCION_12
    SUBF VLV_VEL_12 VLV_CORRECCION_12 F.1
    MATH NEGATE F.1 F.0
    ADDF VLV_VEL_12 VLV_CORRECCION_12 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    MOVEF_F VLV_ERROR_12 VLV_OLDERROR_12
    MATH ABS VLV_ENCODERC_12 F.0
    ADDF VLV_GRADOSACCEL_12 VLV_GRADOSCRUCERO_12 F.2
    ADDF F.2 VLV_GRADOSDECEL_12 F.1
    JR_LTF F.0 F.1 whilebody285
  endwhile285:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
RETSUB_M_RECTO_ACCELDECELF_5:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_RECTO_ACCELDECELF_5:
SUB_M_RECTO_ACCELDECEL_5:
    CALL MOTOR.GETCOUNT 'B' VLV_STARTB_13
    CALL MOTOR.GETCOUNT 'C' VLV_STARTC_13
    MOVEF_F 0.0 VLV_ENCODERB_13
    MOVEF_F 0.0 VLV_ENCODERC_13
    MATH ABS VLV_V0_13 F.0
    DATAF tmpf339
    DATA8 flag339
    DIVF VLV_V0_13 F.0 tmpf339
    CP_EQF 0.0 F.0 flag339
    SELECTF flag339 0.0 tmpf339 VLV_SIGNO_13

    MATH ABS VLV_V0_13 F.1
    DATA8 flag341
	CP_GTF 8.0 F.1 flag341
	SELECTF flag341 8.0 F.1 F.0
    MULF F.0 VLV_SIGNO_13 VLV_V0_13
    MATH ABS VLV_VMAX_13 F.1
    DATA8 flag344
	CP_LTF 90.0 F.1 flag344
	SELECTF flag344 90.0 F.1 F.0
    MULF F.0 VLV_SIGNO_13 VLV_VMAX_13
    MOVEF_F 0.0 VLV_VEL_13
    MOVEF_F 0.4 VLV_KP_13
    MOVEF_F 0.5 VLV_KD_13
    MOVEF_F 0.0 VLV_ERROR_13
    MOVEF_F 0.0 VLV_OLDERROR_13
    MULF VLV_DISTANCIAACCEL_13 360.0 F.0
    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_RECTO_DIAMETRO F.2 F.1
    DATAF tmpf349
    DATA8 flag349
    DIVF F.0 F.1 tmpf349
    CP_EQF 0.0 F.1 flag349
    SELECTF flag349 0.0 tmpf349 VLV_GRADOSACCEL_13

    MULF VLV_DISTANCIACRUCERO_13 360.0 F.0
    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_RECTO_DIAMETRO F.2 F.1
    DATAF tmpf353
    DATA8 flag353
    DIVF F.0 F.1 tmpf353
    CP_EQF 0.0 F.1 flag353
    SELECTF flag353 0.0 tmpf353 VLV_GRADOSCRUCERO_13

    MULF VLV_DISTANCIADECEL_13 360.0 F.0
    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_RECTO_DIAMETRO F.2 F.1
    DATAF tmpf357
    DATA8 flag357
    DIVF F.0 F.1 tmpf357
    CP_EQF 0.0 F.1 flag357
    SELECTF flag357 0.0 tmpf357 VLV_GRADOSDECEL_13

  while358:
    MATH ABS VLV_ENCODERC_13 F.0
    ADDF VLV_GRADOSACCEL_13 VLV_GRADOSCRUCERO_13 F.2
    ADDF F.2 VLV_GRADOSDECEL_13 F.1
    JR_GTEQF F.0 F.1 endwhile358
  whilebody358:
    CALL MOTOR.GETCOUNT 'B' F.1
    MULF F.1 1.0 F.0
    SUBF F.0 VLV_STARTB_13 VLV_ENCODERB_13
    CALL MOTOR.GETCOUNT 'C' F.0
    SUBF F.0 VLV_STARTC_13 VLV_ENCODERC_13
    MATH ABS VLV_ENCODERC_13 F.0
    ADDF VLV_GRADOSACCEL_13 VLV_GRADOSCRUCERO_13 F.1
    JR_GTEQF F.0 F.1 else367_1
    SUBF VLV_VMAX_13 VLV_V0_13 F.1
    DATAF tmpf371
    DATA8 flag371
    DIVF F.1 VLV_GRADOSACCEL_13 tmpf371
    CP_EQF 0.0 VLV_GRADOSACCEL_13 flag371
    SELECTF flag371 0.0 tmpf371 F.0

    MULF F.0 VLV_SIGNO_13 VLV_PENDIENTE_13
    JR_LTEQF VLV_SIGNO_13 0.0 else373_1
    MULF VLV_PENDIENTE_13 VLV_ENCODERC_13 F.1
    ADDF F.1 VLV_V0_13 F.0
    DATA8 flag376
	CP_LTF VLV_VMAX_13 F.0 flag376
	SELECTF flag376 VLV_VMAX_13 F.0 VLV_VEL_13
    JR endif373
  else373_1:
    MULF VLV_PENDIENTE_13 VLV_ENCODERC_13 F.1
    ADDF F.1 VLV_V0_13 F.0
    DATA8 flag379
	CP_GTF VLV_VMAX_13 F.0 flag379
	SELECTF flag379 VLV_VMAX_13 F.0 VLV_VEL_13
  else373_2:
  endif373:
    JR endif367
  else367_1:
    SUBF VLV_V0_13 VLV_VMAX_13 F.1
    DATAF tmpf381
    DATA8 flag381
    DIVF F.1 VLV_GRADOSDECEL_13 tmpf381
    CP_EQF 0.0 VLV_GRADOSDECEL_13 flag381
    SELECTF flag381 0.0 tmpf381 F.0

    MULF F.0 VLV_SIGNO_13 VLV_PENDIENTE_13
    JR_LTEQF VLV_SIGNO_13 0.0 else383_1
    SUBF VLV_ENCODERC_13 VLV_GRADOSACCEL_13 F.3
    SUBF F.3 VLV_GRADOSCRUCERO_13 F.2
    MULF VLV_PENDIENTE_13 F.2 F.1
    ADDF F.1 VLV_VMAX_13 F.0
    DATA8 flag388
	CP_GTF VLV_V0_13 F.0 flag388
	SELECTF flag388 VLV_V0_13 F.0 VLV_VEL_13
    JR endif383
  else383_1:
    ADDF VLV_ENCODERC_13 VLV_GRADOSACCEL_13 F.3
    ADDF F.3 VLV_GRADOSCRUCERO_13 F.2
    MULF VLV_PENDIENTE_13 F.2 F.1
    ADDF F.1 VLV_VMAX_13 F.0
    DATA8 flag393
	CP_LTF VLV_V0_13 F.0 flag393
	SELECTF flag393 VLV_V0_13 F.0 VLV_VEL_13
  else383_2:
  endif383:
  else367_2:
  endif367:
    MULF -1.0 VLV_ENCODERB_13 F.1
    SUBF F.1 VLV_ENCODERC_13 F.0
    MULF F.0 1.0 VLV_ERROR_13
    MULF VLV_ERROR_13 VLV_KP_13 F.0
    SUBF VLV_ERROR_13 VLV_OLDERROR_13 F.2
    MULF F.2 VLV_KD_13 F.1
    ADDF F.0 F.1 VLV_CORRECCION_13
    SUBF VLV_VEL_13 VLV_CORRECCION_13 F.1
    MATH NEGATE F.1 F.0
    ADDF VLV_VEL_13 VLV_CORRECCION_13 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    MOVEF_F VLV_ERROR_13 VLV_OLDERROR_13
    MATH ABS VLV_ENCODERC_13 F.0
    ADDF VLV_GRADOSACCEL_13 VLV_GRADOSCRUCERO_13 F.2
    ADDF F.2 VLV_GRADOSDECEL_13 F.1
    JR_LTF F.0 F.1 whilebody358
  endwhile358:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 1
RETSUB_M_RECTO_ACCELDECEL_5:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_RECTO_ACCELDECEL_5:
SUB_M_GIRO_GRADOS_3:
    DATAF tmpf409
    DATA8 flag409
    DIVF VLV_VELOCIDAD1_14 VLV_VELOCIDAD2_14 tmpf409
    CP_EQF 0.0 VLV_VELOCIDAD2_14 flag409
    SELECTF flag409 0.0 tmpf409 F.0

    DATAF tmpf410
    DATA8 flag410
    DIVF VLV_VELOCIDAD1_14 VLV_VELOCIDAD2_14 tmpf410
    CP_EQF 0.0 VLV_VELOCIDAD2_14 flag410
    SELECTF flag410 0.0 tmpf410 F.2

    MATH ABS F.2 F.1
    DATAF tmpf412
    DATA8 flag412
    DIVF F.0 F.1 tmpf412
    CP_EQF 0.0 F.1 flag412
    SELECTF flag412 0.0 tmpf412 VLV_SIGNO_14

    MATH ABS VLV_VELOCIDAD1_14 F.0
    MATH ABS VLV_VELOCIDAD2_14 F.1
    DATA8 flag415
	CP_LTF F.0 F.1 flag415
	SELECTF flag415 F.0 F.1 VLV_VMIN_14
    MATH ABS VLV_VELOCIDAD1_14 F.0
    MATH ABS VLV_VELOCIDAD2_14 F.1
    DATA8 flag418
	CP_GTF F.0 F.1 flag418
	SELECTF flag418 F.0 F.1 VLV_VMAX_14
    MULF VLV_GRADOS_14 VPR_GIRO_G1 F.0
    MULF VLV_SIGNO_14 VLV_VMIN_14 F.4
    DATAF tmpf421
    DATA8 flag421
    DIVF F.4 VLV_VMAX_14 tmpf421
    CP_EQF 0.0 VLV_VMAX_14 flag421
    SELECTF flag421 0.0 tmpf421 F.3

    SUBF F.3 1.0 F.2
    DATAF tmpf423
    DATA8 flag423
    DIVF -2.0 F.2 tmpf423
    CP_EQF 0.0 F.2 flag423
    SELECTF flag423 0.0 tmpf423 F.1

    MULF F.0 F.1 VLV_ENCODER_14
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
    DATA32 milliseconds426
	MOVEF_32 100.0 milliseconds426
	DATA32 timer426
	TIMER_WAIT milliseconds426 timer426
	TIMER_READY timer426
    MATH NEGATE VLV_VELOCIDAD1_14 F.0
    CALL MOTOR.SCHEDULESYNC 'BC' F.0 VLV_VELOCIDAD2_14 VLV_ENCODER_14 'True'

	DATA8 layer428
	DATA8 nos428
	DATA8 busy428
	CALL MOTORDECODEPORTSDESCRIPTOR 'BC' layer428 nos428
	JR_EQ8 0 nos428 motornotbusy428
  motorwaiting428:
	OUTPUT_TEST layer428 nos428 busy428
	JR_EQ8 busy428 0 motornotbusy428
	SLEEP
	JR motorwaiting428
  motornotbusy428:
    MOVEF_F 0.0 VLV_VELOCIDAD1_14
    MOVEF_F 0.0 VLV_VELOCIDAD2_14
    MOVEF_F 0.0 VLV_GRADOS_14
    DATA32 milliseconds429
	MOVEF_32 100.0 milliseconds429
	DATA32 timer429
	TIMER_WAIT milliseconds429 timer429
	TIMER_READY timer429
RETSUB_M_GIRO_GRADOS_3:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_GIRO_GRADOS_3:
SUB_M_GIRO_ENCODER_3:
    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_GIRO_DIAMETRO F.2 F.1
    DATAF tmpf432
    DATA8 flag432
    DIVF VLV_DISTANCIA_15 F.1 tmpf432
    CP_EQF 0.0 F.1 flag432
    SELECTF flag432 0.0 tmpf432 F.0

    MULF F.0 360.0 VLV_ENCODER_15
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
    MATH NEGATE VLV_VELOCIDAD1_15 F.0
    CALL MOTOR.SCHEDULESYNC 'BC' F.0 VLV_VELOCIDAD2_15 VLV_ENCODER_15 'True'

	DATA8 layer436
	DATA8 nos436
	DATA8 busy436
	CALL MOTORDECODEPORTSDESCRIPTOR 'BC' layer436 nos436
	JR_EQ8 0 nos436 motornotbusy436
  motorwaiting436:
	OUTPUT_TEST layer436 nos436 busy436
	JR_EQ8 busy436 0 motornotbusy436
	SLEEP
	JR motorwaiting436
  motornotbusy436:
RETSUB_M_GIRO_ENCODER_3:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_GIRO_ENCODER_3:
SUB_M_SIGUELINEAS_CRUCE14_1:
    MULF VLV_VELOCIDAD_16 1.0 VLV_VELOCIDAD_16
    MOVEF_F 50.0 VLV_LECTURA1_16
    MOVEF_F 50.0 VLV_LECTURA3_16
    MOVEF_F 50.0 VLV_LECTURA4_16
    DATAF tmpf438
    DATA8 flag438
    DIVF VLV_VELOCIDAD_16 280.0 tmpf438
    CP_EQF 0.0 280.0 flag438
    SELECTF flag438 0.0 tmpf438 VLV_KP_16

    MULF VLV_KP_16 32.0 VLV_KD_16
    MOVEF_F 0.0 VLV_ERROR_16
    MOVEF_F 0.0 VLV_OLDERROR_16
    MOVEF_F 0.0 VLV_U_16
    MATH ABS VLV_VELOCIDAD_16 F.0
    DATAF tmpf441
    DATA8 flag441
    DIVF VLV_VELOCIDAD_16 F.0 tmpf441
    CP_EQF 0.0 F.0 flag441
    SELECTF flag441 0.0 tmpf441 VLV_SENTIDO_16

  while442:
    JR_GTF VLV_LECTURA1_16 10.0 or443
    JR_LTEQF VLV_LECTURA4_16 10.0 endwhile442
  or443:
  whilebody442:
    CALL SENSOR.READPERCENT 1.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO1 F.1
    DATAF tmpf446
    DATA8 flag446
    DIVF F.1 VPR_SIGUELINEAS_BLANCO1 tmpf446
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO1 flag446
    SELECTF flag446 0.0 tmpf446 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO1 F.1
    MULF F.0 F.1 VLV_LECTURA1_16
    CALL SENSOR.READPERCENT 4.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO4 F.1
    DATAF tmpf451
    DATA8 flag451
    DIVF F.1 VPR_SIGUELINEAS_BLANCO4 tmpf451
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO4 flag451
    SELECTF flag451 0.0 tmpf451 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO4 F.1
    MULF F.0 F.1 VLV_LECTURA4_16
    SUBF VLV_LECTURA1_16 VLV_LECTURA4_16 F.1
    MULF F.1 VLV_SENTIDO_16 F.0
    MULF F.0 1.0 VLV_ERROR_16
    MULF VLV_ERROR_16 VLV_KP_16 F.0
    SUBF VLV_ERROR_16 VLV_OLDERROR_16 F.2
    MULF F.2 VLV_KD_16 F.1
    ADDF F.0 F.1 VLV_U_16
    ADDF VLV_VELOCIDAD_16 VLV_U_16 F.1
    MATH NEGATE F.1 F.0
    SUBF VLV_VELOCIDAD_16 VLV_U_16 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    MOVEF_F VLV_ERROR_16 VLV_OLDERROR_16
    JR_GTF VLV_LECTURA1_16 10.0 whilebody442
    JR_GTF VLV_LECTURA4_16 10.0 whilebody442
  endwhile442:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 1
RETSUB_M_SIGUELINEAS_CRUCE14_1:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_SIGUELINEAS_CRUCE14_1:
SUB_M_SIGUELINEAS_ENCODER31_2:
    MULF VLV_VELOCIDAD_17 1.0 VLV_VELOCIDAD_17
    MOVEF_F 50.0 VLV_LECTURA1_17
    MOVEF_F 50.0 VLV_LECTURA3_17
    MOVEF_F 50.0 VLV_LECTURA4_17
    DATAF tmpf467
    DATA8 flag467
    DIVF VLV_VELOCIDAD_17 280.0 tmpf467
    CP_EQF 0.0 280.0 flag467
    SELECTF flag467 0.0 tmpf467 VLV_KP_17

    MULF VLV_KP_17 32.0 VLV_KD_17
    MOVEF_F 0.0 VLV_ERROR_17
    MOVEF_F 0.0 VLV_OLDERROR_17
    MOVEF_F 0.0 VLV_U_17
    MATH ABS VLV_VELOCIDAD_17 F.0
    DATAF tmpf470
    DATA8 flag470
    DIVF VLV_VELOCIDAD_17 F.0 tmpf470
    CP_EQF 0.0 F.0 flag470
    SELECTF flag470 0.0 tmpf470 VLV_SENTIDO_17

    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_SIGUELINEAS_DIAMETRO F.2 F.1
    DATAF tmpf473
    DATA8 flag473
    DIVF VLV_ENCODER_17 F.1 tmpf473
    CP_EQF 0.0 F.1 flag473
    SELECTF flag473 0.0 tmpf473 F.0

    MULF F.0 360.0 VLV_ENCODER_17
    OUTPUT_GET_COUNT 0 2 getTachoC
	MOVE32_F getTachoC VLV_STARTC_17
    MOVEF_F 0.0 VLV_ENCODERC_17
  while476:
    MATH ABS VLV_ENCODERC_17 F.0
    JR_GTEQF F.0 VLV_ENCODER_17 endwhile476
  whilebody476:
    OUTPUT_GET_COUNT 0 2 getTachoC
	MOVE32_F getTachoC F.0
    SUBF F.0 VLV_STARTC_17 VLV_ENCODERC_17
    CALL SENSOR.READPERCENT 1.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO1 F.1
    DATAF tmpf482
    DATA8 flag482
    DIVF F.1 VPR_SIGUELINEAS_BLANCO1 tmpf482
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO1 flag482
    SELECTF flag482 0.0 tmpf482 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO1 F.1
    MULF F.0 F.1 VLV_LECTURA1_17
    CALL SENSOR.READPERCENT 3.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO3 F.1
    DATAF tmpf487
    DATA8 flag487
    DIVF F.1 VPR_SIGUELINEAS_BLANCO3 tmpf487
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO3 flag487
    SELECTF flag487 0.0 tmpf487 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO3 F.1
    MULF F.0 F.1 VLV_LECTURA3_17
    SUBF VLV_LECTURA3_17 VLV_LECTURA1_17 F.1
    MULF F.1 VLV_SENTIDO_17 F.0
    MULF F.0 1.0 VLV_ERROR_17
    MULF VLV_ERROR_17 VLV_KP_17 F.0
    SUBF VLV_ERROR_17 VLV_OLDERROR_17 F.2
    MULF F.2 VLV_KD_17 F.1
    ADDF F.0 F.1 VLV_U_17
    ADDF VLV_VELOCIDAD_17 VLV_U_17 F.1
    MATH NEGATE F.1 F.0
    SUBF VLV_VELOCIDAD_17 VLV_U_17 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    MOVEF_F VLV_ERROR_17 VLV_OLDERROR_17
    MATH ABS VLV_ENCODERC_17 F.0
    JR_LTF F.0 VLV_ENCODER_17 whilebody476
  endwhile476:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 1
RETSUB_M_SIGUELINEAS_ENCODER31_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_SIGUELINEAS_ENCODER31_2:
SUB_M_SIGUELINEAS_ENCODER14_2:
    MULF VLV_VELOCIDAD_18 1.0 VLV_VELOCIDAD_18
    MOVEF_F 50.0 VLV_LECTURA1_18
    MOVEF_F 50.0 VLV_LECTURA3_18
    MOVEF_F 50.0 VLV_LECTURA4_18
    DATAF tmpf504
    DATA8 flag504
    DIVF VLV_VELOCIDAD_18 320.0 tmpf504
    CP_EQF 0.0 320.0 flag504
    SELECTF flag504 0.0 tmpf504 VLV_KP_18

    MULF VLV_KP_18 28.0 VLV_KD_18
    MOVEF_F 0.0 VLV_ERROR_18
    MOVEF_F 0.0 VLV_OLDERROR_18
    MOVEF_F 0.0 VLV_U_18
    MATH ABS VLV_VELOCIDAD_18 F.0
    DATAF tmpf507
    DATA8 flag507
    DIVF VLV_VELOCIDAD_18 F.0 tmpf507
    CP_EQF 0.0 F.0 flag507
    SELECTF flag507 0.0 tmpf507 VLV_SENTIDO_18

    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_SIGUELINEAS_DIAMETRO F.2 F.1
    DATAF tmpf510
    DATA8 flag510
    DIVF VLV_ENCODER_18 F.1 tmpf510
    CP_EQF 0.0 F.1 flag510
    SELECTF flag510 0.0 tmpf510 F.0

    MULF F.0 360.0 VLV_ENCODER_18
    OUTPUT_GET_COUNT 0 2 getTachoC
	MOVE32_F getTachoC VLV_STARTC_18
    MOVEF_F 0.0 VLV_ENCODERC_18
  while513:
    MATH ABS VLV_ENCODERC_18 F.0
    JR_GTEQF F.0 VLV_ENCODER_18 endwhile513
  whilebody513:
    OUTPUT_GET_COUNT 0 2 getTachoC
	MOVE32_F getTachoC F.0
    SUBF F.0 VLV_STARTC_18 VLV_ENCODERC_18
    CALL SENSOR.READPERCENT 1.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO1 F.1
    DATAF tmpf519
    DATA8 flag519
    DIVF F.1 VPR_SIGUELINEAS_BLANCO1 tmpf519
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO1 flag519
    SELECTF flag519 0.0 tmpf519 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO1 F.1
    MULF F.0 F.1 VLV_LECTURA1_18
    CALL SENSOR.READPERCENT 4.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO4 F.1
    DATAF tmpf524
    DATA8 flag524
    DIVF F.1 VPR_SIGUELINEAS_BLANCO4 tmpf524
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO4 flag524
    SELECTF flag524 0.0 tmpf524 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO4 F.1
    MULF F.0 F.1 VLV_LECTURA4_18
    SUBF VLV_LECTURA1_18 VLV_LECTURA4_18 F.1
    MULF F.1 VLV_SENTIDO_18 F.0
    MULF F.0 1.0 VLV_ERROR_18
    MULF VLV_ERROR_18 VLV_KP_18 F.0
    SUBF VLV_ERROR_18 VLV_OLDERROR_18 F.2
    MULF F.2 VLV_KD_18 F.1
    ADDF F.0 F.1 VLV_U_18
    ADDF VLV_VELOCIDAD_18 VLV_U_18 F.1
    MATH NEGATE F.1 F.0
    SUBF VLV_VELOCIDAD_18 VLV_U_18 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    MOVEF_F VLV_ERROR_18 VLV_OLDERROR_18
    MATH ABS VLV_ENCODERC_18 F.0
    JR_LTF F.0 VLV_ENCODER_18 whilebody513
  endwhile513:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 1
RETSUB_M_SIGUELINEAS_ENCODER14_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_SIGUELINEAS_ENCODER14_2:
SUB_M_SIGUELINEAS_CRUCE_EXTERNO_2:
    MULF VLV_VELOCIDAD_19 1.0 VLV_VELOCIDAD_19
    MOVEF_F 50.0 VLV_LECTURA1_19
    MOVEF_F 50.0 VLV_LECTURA3_19
    MOVEF_F 50.0 VLV_LECTURA4_19
    DATAF tmpf541
    DATA8 flag541
    DIVF VLV_VELOCIDAD_19 280.0 tmpf541
    CP_EQF 0.0 280.0 flag541
    SELECTF flag541 0.0 tmpf541 VLV_KP_19

    MULF VLV_KP_19 32.0 VLV_KD_19
    MOVEF_F 0.0 VLV_ERROR_19
    MOVEF_F 0.0 VLV_OLDERROR_19
    MOVEF_F 0.0 VLV_U_19
    MATH ABS VLV_VELOCIDAD_19 F.0
    DATAF tmpf544
    DATA8 flag544
    DIVF VLV_VELOCIDAD_19 F.0 tmpf544
    CP_EQF 0.0 F.0 flag544
    SELECTF flag544 0.0 tmpf544 VLV_SENTIDO_19

    MOVEF_F 50.0 VLV_LECTURA_19
  while545:
    JR_LTEQF VLV_LECTURA_19 7.0 endwhile545
  whilebody545:
    JR_NEQF VLV_READER_19 3.0 else546_1
    MOVEF_F VLV_LECTURA3_19 VLV_LECTURA_19
    MOVEF_F VLV_LECTURA1_19 VLV_LECTURAIZQ_19
    MOVEF_F VLV_LECTURA4_19 VLV_LECTURADCH_19
    JR endif546
  else546_1:
    MOVEF_F VLV_LECTURA4_19 VLV_LECTURA_19
    MOVEF_F VLV_LECTURA3_19 VLV_LECTURAIZQ_19
    MOVEF_F VLV_LECTURA1_19 VLV_LECTURADCH_19
  else546_2:
  endif546:
    CALL SENSOR.READPERCENT 1.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO1 F.1
    DATAF tmpf549
    DATA8 flag549
    DIVF F.1 VPR_SIGUELINEAS_BLANCO1 tmpf549
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO1 flag549
    SELECTF flag549 0.0 tmpf549 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO1 F.1
    MULF F.0 F.1 VLV_LECTURA1_19
    CALL SENSOR.READPERCENT 3.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO3 F.1
    DATAF tmpf554
    DATA8 flag554
    DIVF F.1 VPR_SIGUELINEAS_BLANCO3 tmpf554
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO3 flag554
    SELECTF flag554 0.0 tmpf554 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO3 F.1
    MULF F.0 F.1 VLV_LECTURA3_19
    CALL SENSOR.READPERCENT 4.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO4 F.1
    DATAF tmpf559
    DATA8 flag559
    DIVF F.1 VPR_SIGUELINEAS_BLANCO4 tmpf559
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO4 flag559
    SELECTF flag559 0.0 tmpf559 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO4 F.1
    MULF F.0 F.1 VLV_LECTURA4_19
    SUBF VLV_LECTURAIZQ_19 VLV_LECTURADCH_19 F.1
    MULF F.1 VLV_SENTIDO_19 F.0
    MULF F.0 1.0 VLV_ERROR_19
    MULF VLV_ERROR_19 VLV_KP_19 F.0
    SUBF VLV_ERROR_19 VLV_OLDERROR_19 F.2
    MULF F.2 VLV_KD_19 F.1
    ADDF F.0 F.1 VLV_U_19
    ADDF VLV_VELOCIDAD_19 VLV_U_19 F.1
    MATH NEGATE F.1 F.0
    SUBF VLV_VELOCIDAD_19 VLV_U_19 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    MOVEF_F VLV_ERROR_19 VLV_OLDERROR_19
    JR_GTF VLV_LECTURA_19 7.0 whilebody545
  endwhile545:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 1
RETSUB_M_SIGUELINEAS_CRUCE_EXTERNO_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_SIGUELINEAS_CRUCE_EXTERNO_2:
SUB_M_SIGUELINEAS_CRUCE_EXTERNOF_2:
    MULF VLV_VELOCIDAD_20 1.0 VLV_VELOCIDAD_20
    MOVEF_F 50.0 VLV_LECTURA1_20
    MOVEF_F 50.0 VLV_LECTURA3_20
    MOVEF_F 50.0 VLV_LECTURA4_20
    DATAF tmpf575
    DATA8 flag575
    DIVF VLV_VELOCIDAD_20 280.0 tmpf575
    CP_EQF 0.0 280.0 flag575
    SELECTF flag575 0.0 tmpf575 VLV_KP_20

    MULF VLV_KP_20 32.0 VLV_KD_20
    MOVEF_F 0.0 VLV_ERROR_20
    MOVEF_F 0.0 VLV_OLDERROR_20
    MOVEF_F 0.0 VLV_U_20
    MATH ABS VLV_VELOCIDAD_20 F.0
    DATAF tmpf578
    DATA8 flag578
    DIVF VLV_VELOCIDAD_20 F.0 tmpf578
    CP_EQF 0.0 F.0 flag578
    SELECTF flag578 0.0 tmpf578 VLV_SENTIDO_20

    MOVEF_F 50.0 VLV_LECTURA_20
  while579:
    JR_LTEQF VLV_LECTURA_20 7.0 endwhile579
  whilebody579:
    JR_NEQF VLV_READER_20 3.0 else580_1
    MOVEF_F VLV_LECTURA3_20 VLV_LECTURA_20
    MOVEF_F VLV_LECTURA1_20 VLV_LECTURAIZQ_20
    MOVEF_F VLV_LECTURA4_20 VLV_LECTURADCH_20
    JR endif580
  else580_1:
    MOVEF_F VLV_LECTURA4_20 VLV_LECTURA_20
    MOVEF_F VLV_LECTURA3_20 VLV_LECTURAIZQ_20
    MOVEF_F VLV_LECTURA1_20 VLV_LECTURADCH_20
  else580_2:
  endif580:
    CALL SENSOR.READPERCENT 1.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO1 F.1
    DATAF tmpf583
    DATA8 flag583
    DIVF F.1 VPR_SIGUELINEAS_BLANCO1 tmpf583
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO1 flag583
    SELECTF flag583 0.0 tmpf583 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO1 F.1
    MULF F.0 F.1 VLV_LECTURA1_20
    CALL SENSOR.READPERCENT 3.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO3 F.1
    DATAF tmpf588
    DATA8 flag588
    DIVF F.1 VPR_SIGUELINEAS_BLANCO3 tmpf588
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO3 flag588
    SELECTF flag588 0.0 tmpf588 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO3 F.1
    MULF F.0 F.1 VLV_LECTURA3_20
    CALL SENSOR.READPERCENT 4.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO4 F.1
    DATAF tmpf593
    DATA8 flag593
    DIVF F.1 VPR_SIGUELINEAS_BLANCO4 tmpf593
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO4 flag593
    SELECTF flag593 0.0 tmpf593 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO4 F.1
    MULF F.0 F.1 VLV_LECTURA4_20
    SUBF VLV_LECTURAIZQ_20 VLV_LECTURADCH_20 F.1
    MULF F.1 VLV_SENTIDO_20 F.0
    MULF F.0 1.0 VLV_ERROR_20
    MULF VLV_ERROR_20 VLV_KP_20 F.0
    SUBF VLV_ERROR_20 VLV_OLDERROR_20 F.2
    MULF F.2 VLV_KD_20 F.1
    ADDF F.0 F.1 VLV_U_20
    ADDF VLV_VELOCIDAD_20 VLV_U_20 F.1
    MATH NEGATE F.1 F.0
    SUBF VLV_VELOCIDAD_20 VLV_U_20 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    MOVEF_F VLV_ERROR_20 VLV_OLDERROR_20
    JR_GTF VLV_LECTURA_20 7.0 whilebody579
  endwhile579:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
RETSUB_M_SIGUELINEAS_CRUCE_EXTERNOF_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_SIGUELINEAS_CRUCE_EXTERNOF_2:
SUB_M_SIGUELINEAS_ENCODER31F_2:
    MULF VLV_VELOCIDAD_21 1.0 VLV_VELOCIDAD_21
    MOVEF_F 50.0 VLV_LECTURA1_21
    MOVEF_F 50.0 VLV_LECTURA3_21
    MOVEF_F 50.0 VLV_LECTURA4_21
    DATAF tmpf609
    DATA8 flag609
    DIVF VLV_VELOCIDAD_21 280.0 tmpf609
    CP_EQF 0.0 280.0 flag609
    SELECTF flag609 0.0 tmpf609 VLV_KP_21

    MULF VLV_KP_21 32.0 VLV_KD_21
    MOVEF_F 0.0 VLV_ERROR_21
    MOVEF_F 0.0 VLV_OLDERROR_21
    MOVEF_F 0.0 VLV_U_21
    MATH ABS VLV_VELOCIDAD_21 F.0
    DATAF tmpf612
    DATA8 flag612
    DIVF VLV_VELOCIDAD_21 F.0 tmpf612
    CP_EQF 0.0 F.0 flag612
    SELECTF flag612 0.0 tmpf612 VLV_SENTIDO_21

    MOVEF_F 3.1415926535897932384 F.2
    MULF VPR_SIGUELINEAS_DIAMETRO F.2 F.1
    DATAF tmpf615
    DATA8 flag615
    DIVF VLV_ENCODER_21 F.1 tmpf615
    CP_EQF 0.0 F.1 flag615
    SELECTF flag615 0.0 tmpf615 F.0

    MULF F.0 360.0 VLV_ENCODER_21
    OUTPUT_GET_COUNT 0 2 getTachoC
	MOVE32_F getTachoC VLV_STARTC_21
    MOVEF_F 0.0 VLV_ENCODERC_21
  while618:
    MATH ABS VLV_ENCODERC_21 F.0
    JR_GTEQF F.0 VLV_ENCODER_21 endwhile618
  whilebody618:
    OUTPUT_GET_COUNT 0 2 getTachoC
	MOVE32_F getTachoC F.0
    SUBF F.0 VLV_STARTC_21 VLV_ENCODERC_21
    CALL SENSOR.READPERCENT 1.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO1 F.1
    DATAF tmpf624
    DATA8 flag624
    DIVF F.1 VPR_SIGUELINEAS_BLANCO1 tmpf624
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO1 flag624
    SELECTF flag624 0.0 tmpf624 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO1 F.1
    MULF F.0 F.1 VLV_LECTURA1_21
    CALL SENSOR.READPERCENT 3.0 F.2
    SUBF F.2 VPR_SIGUELINEAS_NEGRO3 F.1
    DATAF tmpf629
    DATA8 flag629
    DIVF F.1 VPR_SIGUELINEAS_BLANCO3 tmpf629
    CP_EQF 0.0 VPR_SIGUELINEAS_BLANCO3 flag629
    SELECTF flag629 0.0 tmpf629 F.0

    SUBF 100.0 VPR_SIGUELINEAS_NEGRO3 F.1
    MULF F.0 F.1 VLV_LECTURA3_21
    SUBF VLV_LECTURA3_21 VLV_LECTURA1_21 F.1
    MULF F.1 VLV_SENTIDO_21 F.0
    MULF F.0 1.0 VLV_ERROR_21
    MULF VLV_ERROR_21 VLV_KP_21 F.0
    SUBF VLV_ERROR_21 VLV_OLDERROR_21 F.2
    MULF F.2 VLV_KD_21 F.1
    ADDF F.0 F.1 VLV_U_21
    ADDF VLV_VELOCIDAD_21 VLV_U_21 F.1
    MATH NEGATE F.1 F.0
    SUBF VLV_VELOCIDAD_21 VLV_U_21 F.1
    CALL MOTOR.STARTSYNC 'BC' F.0 F.1
    MOVEF_F VLV_ERROR_21 VLV_OLDERROR_21
    MATH ABS VLV_ENCODERC_21 F.0
    JR_LTF F.0 VLV_ENCODER_21 whilebody618
  endwhile618:
    OUTPUT_POWER 0 6 0
	OUTPUT_STOP 0 6 0
RETSUB_M_SIGUELINEAS_ENCODER31F_2:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_SIGUELINEAS_ENCODER31F_2:
SUB_M_RGB_DETECT_3:
    CALL SENSOR.GETMODE VLV_SENS_22 VLV_SENS_MODE_22
    DATA8 layer646
	DATA8 no646
	DATA8 mode8646
	
	MOVEF_8 VLV_SENS_22 no646
	SUB8 no646 1 no646
	DIV8 no646 4 layer646
	MATH MOD8 no646 4 no646

	MOVEF_8 4.0 mode8646
	
	INPUT_DEVICE READY_RAW layer646 no646 0 mode8646 0
    MOVEF_F 15.0 VLV_RED_22
    MOVEF_F 60.0 VLV_YELLOW_22
    MOVEF_F 170.0 VLV_GREEN_22
    MOVEF_F 330.0 VLV_BLUE_22
    MOVEF_F 0.0 VLV_HUE_22
    MOVEF_F 0.0 VLV_SAT_22
    MOVEF_F 0.0 VLV_VALUE_22
    MOVEF_F 0.0 VLV_COLOR_22
    CALL ARRAYSTORE_FLOAT 0.0 0.0 VLV_RNORMARRAY_22
    CALL ARRAYSTORE_FLOAT 0.0 0.0 VLV_GNORMARRAY_22
    CALL ARRAYSTORE_FLOAT 0.0 0.0 VLV_BNORMARRAY_22
    CALL LCD.CLEAR
    MOVEF_F 1.0 VLV_J_22
  for651:
    JR_GTF VLV_J_22 VLV_REPS_22 endfor651
  forbody651:
    CALL SENSOR.READRAW VLV_SENS_22 3.0 VLV_RGB_22
    CALL ARRAYGET_FLOAT 0.0 VLV_RRAW_22 VLV_RGB_22
    CALL ARRAYGET_FLOAT 1.0 VLV_GRAW_22 VLV_RGB_22
    CALL ARRAYGET_FLOAT 2.0 VLV_BRAW_22 VLV_RGB_22
    DATAF tmpf656
    DATA8 flag656
    DIVF VLV_RRAW_22 VPR_RGB_RWHITE tmpf656
    CP_EQF 0.0 VPR_RGB_RWHITE flag656
    SELECTF flag656 0.0 tmpf656 F.2

    MULF F.2 255.0 F.1
    MATH ROUND F.1 F.0
    CALL ARRAYSTORE_FLOAT VLV_J_22 F.0 VLV_RNORMARRAY_22
    DATAF tmpf660
    DATA8 flag660
    DIVF VLV_GRAW_22 VPR_RGB_GWHITE tmpf660
    CP_EQF 0.0 VPR_RGB_GWHITE flag660
    SELECTF flag660 0.0 tmpf660 F.2

    MULF F.2 255.0 F.1
    MATH ROUND F.1 F.0
    CALL ARRAYSTORE_FLOAT VLV_J_22 F.0 VLV_GNORMARRAY_22
    DATAF tmpf664
    DATA8 flag664
    DIVF VLV_BRAW_22 VPR_RGB_BWHITE tmpf664
    CP_EQF 0.0 VPR_RGB_BWHITE flag664
    SELECTF flag664 0.0 tmpf664 F.2

    MULF F.2 255.0 F.1
    MATH ROUND F.1 F.0
    CALL ARRAYSTORE_FLOAT VLV_J_22 F.0 VLV_BNORMARRAY_22
    DATA32 milliseconds668
	MOVEF_32 5.0 milliseconds668
	DATA32 timer668
	TIMER_WAIT milliseconds668 timer668
	TIMER_READY timer668
    ADDF VLV_J_22 1.0 VLV_J_22
    JR_LTEQF VLV_J_22 VLV_REPS_22 forbody651
  endfor651:
    MOVEF_F 1.0 VLV_J_22
  for670:
    JR_GTF VLV_J_22 VLV_REPS_22 endfor670
  forbody670:
    CALL ARRAYGET_FLOAT VLV_J_22 F.0 VLV_RNORMARRAY_22
    ADDF VLV_J_22 1.0 F.2
    CALL ARRAYGET_FLOAT F.2 F.1 VLV_RNORMARRAY_22
    ADDF F.0 F.1 VLV_RNORM_22
    CALL ARRAYGET_FLOAT VLV_J_22 F.0 VLV_GNORMARRAY_22
    ADDF VLV_J_22 1.0 F.2
    CALL ARRAYGET_FLOAT F.2 F.1 VLV_GNORMARRAY_22
    ADDF F.0 F.1 VLV_GNORM_22
    CALL ARRAYGET_FLOAT VLV_J_22 F.0 VLV_BNORMARRAY_22
    ADDF VLV_J_22 1.0 F.2
    CALL ARRAYGET_FLOAT F.2 F.1 VLV_BNORMARRAY_22
    ADDF F.0 F.1 VLV_BNORM_22
    ADDF VLV_J_22 2.0 VLV_J_22
    JR_LTEQF VLV_J_22 VLV_REPS_22 forbody670
  endfor670:
    DATAF tmpf684
    DATA8 flag684
    DIVF VLV_RNORM_22 VLV_REPS_22 tmpf684
    CP_EQF 0.0 VLV_REPS_22 flag684
    SELECTF flag684 0.0 tmpf684 VLV_RNORM_22

    DATAF tmpf685
    DATA8 flag685
    DIVF VLV_GNORM_22 VLV_REPS_22 tmpf685
    CP_EQF 0.0 VLV_REPS_22 flag685
    SELECTF flag685 0.0 tmpf685 VLV_GNORM_22

    DATAF tmpf686
    DATA8 flag686
    DIVF VLV_BNORM_22 VLV_REPS_22 tmpf686
    CP_EQF 0.0 VLV_REPS_22 flag686
    SELECTF flag686 0.0 tmpf686 VLV_BNORM_22

    DATA8 flag687
	CP_GTF VLV_RNORM_22 VLV_GNORM_22 flag687
	SELECTF flag687 VLV_RNORM_22 VLV_GNORM_22 F.0
    DATA8 flag688
	CP_GTF F.0 VLV_BNORM_22 flag688
	SELECTF flag688 F.0 VLV_BNORM_22 VLV_MAX_22
    DATA8 flag689
	CP_LTF VLV_RNORM_22 VLV_GNORM_22 flag689
	SELECTF flag689 VLV_RNORM_22 VLV_GNORM_22 F.0
    DATA8 flag690
	CP_LTF F.0 VLV_BNORM_22 flag690
	SELECTF flag690 F.0 VLV_BNORM_22 VLV_MIN_22
    JR_NEQF VLV_MAX_22 VLV_MIN_22 else691_1
    MOVEF_F 0.0 VLV_HUE_22
    JR endif691
  else691_1:
    JR_NEQF VLV_MAX_22 VLV_RNORM_22 else691_2
    JR_LTF VLV_GNORM_22 VLV_BNORM_22 else692_1
    SUBF VLV_GNORM_22 VLV_BNORM_22 F.1
    MULF 60.0 F.1 F.0
    SUBF VLV_MAX_22 VLV_MIN_22 F.1
    DATAF tmpf696
    DATA8 flag696
    DIVF F.0 F.1 tmpf696
    CP_EQF 0.0 F.1 flag696
    SELECTF flag696 0.0 tmpf696 VLV_HUE_22

    JR endif692
  else692_1:
    SUBF VLV_GNORM_22 VLV_BNORM_22 F.2
    MULF 60.0 F.2 F.1
    SUBF VLV_MAX_22 VLV_MIN_22 F.2
    DATAF tmpf700
    DATA8 flag700
    DIVF F.1 F.2 tmpf700
    CP_EQF 0.0 F.2 flag700
    SELECTF flag700 0.0 tmpf700 F.0

    ADDF F.0 360.0 VLV_HUE_22
  else692_2:
  endif692:
    JR endif691
  else691_2:
    JR_NEQF VLV_MAX_22 VLV_GNORM_22 else691_3
    SUBF VLV_BNORM_22 VLV_RNORM_22 F.2
    MULF 60.0 F.2 F.1
    SUBF VLV_MAX_22 VLV_MIN_22 F.2
    DATAF tmpf705
    DATA8 flag705
    DIVF F.1 F.2 tmpf705
    CP_EQF 0.0 F.2 flag705
    SELECTF flag705 0.0 tmpf705 F.0

    ADDF F.0 120.0 VLV_HUE_22
    JR endif691
  else691_3:
    SUBF VLV_RNORM_22 VLV_GNORM_22 F.2
    MULF 60.0 F.2 F.1
    SUBF VLV_MAX_22 VLV_MIN_22 F.2
    DATAF tmpf710
    DATA8 flag710
    DIVF F.1 F.2 tmpf710
    CP_EQF 0.0 F.2 flag710
    SELECTF flag710 0.0 tmpf710 F.0

    ADDF F.0 240.0 VLV_HUE_22
  else691_4:
  endif691:
    JR_NEQF VLV_MAX_22 0.0 else712_1
    MOVEF_F 0.0 VLV_SAT_22
    JR endif712
  else712_1:
    DATAF tmpf713
    DATA8 flag713
    DIVF VLV_MIN_22 VLV_MAX_22 tmpf713
    CP_EQF 0.0 VLV_MAX_22 flag713
    SELECTF flag713 0.0 tmpf713 F.0

    SUBF 1.0 F.0 VLV_SAT_22
  else712_2:
  endif712:
    MOVEF_F VLV_MAX_22 VLV_VALUE_22
    ADDF VPR_RGB_VALUEBLANCO VPR_RGB_VALUENEGRO F.0
    DATAF tmpf716
    DATA8 flag716
    DIVF F.0 2.0 tmpf716
    CP_EQF 0.0 2.0 flag716
    SELECTF flag716 0.0 tmpf716 VLV_RGBGREY_22

    ADDF VLV_RRAW_22 VLV_GRAW_22 F.1
    ADDF F.1 VLV_BRAW_22 F.0
    JR_GTF F.0 3.0 else717_1
    MOVEF_F 0.0 VLV_COLOR_22
    JR endif717
  else717_1:
    JR_GTEQF VLV_SAT_22 0.3 else720_1
    JR_LTEQF VLV_VALUE_22 VLV_RGBGREY_22 else721_1
    MOVEF_F 6.0 VLV_COLOR_22
    JR endif721
  else721_1:
    MOVEF_F 1.0 VLV_COLOR_22
  else721_2:
  endif721:
    JR endif720
  else720_1:
    JR_LTF VLV_HUE_22 0.0 else722_1
    JR_GTEQF VLV_HUE_22 VLV_RED_22 else722_1
    MOVEF_F 5.0 VLV_COLOR_22
    JR endif722
  else722_1:
    JR_LTF VLV_HUE_22 VLV_RED_22 else722_2
    JR_GTEQF VLV_HUE_22 VLV_YELLOW_22 else722_2
    MOVEF_F 4.0 VLV_COLOR_22
    JR endif722
  else722_2:
    JR_LTF VLV_HUE_22 VLV_YELLOW_22 else722_3
    JR_GTEQF VLV_HUE_22 VLV_GREEN_22 else722_3
    MOVEF_F 3.0 VLV_COLOR_22
    JR endif722
  else722_3:
    JR_LTF VLV_HUE_22 VLV_GREEN_22 else722_4
    JR_GTEQF VLV_HUE_22 VLV_BLUE_22 else722_4
    MOVEF_F 2.0 VLV_COLOR_22
    JR endif722
  else722_4:
    MOVEF_F 5.0 VLV_COLOR_22
  else722_5:
  endif722:
  else720_2:
  endif720:
  else717_2:
  endif717:
    MOVE32_32 1 STOPLCDUPDATE
    CALL LCD.CLEAR
    STRINGS VALUE_FORMATTED VLV_RRAW_22 '%g' 99 S.1
    CALL TEXT.APPEND 'R: ' S.1 S.0
    CALL LCD.WRITE 33.0 20.0 S.0
    STRINGS VALUE_FORMATTED VLV_GRAW_22 '%g' 99 S.1
    CALL TEXT.APPEND 'G: ' S.1 S.0
    CALL LCD.WRITE 33.0 35.0 S.0
    STRINGS VALUE_FORMATTED VLV_BRAW_22 '%g' 99 S.1
    CALL TEXT.APPEND 'B: ' S.1 S.0
    CALL LCD.WRITE 33.0 50.0 S.0
    STRINGS VALUE_FORMATTED VLV_COLOR_22 '%g' 99 S.1
    CALL TEXT.APPEND 'color: ' S.1 S.0
    CALL LCD.WRITE 33.0 70.0 S.0
    STRINGS VALUE_FORMATTED VLV_VALUE_22 '%g' 99 S.1
    CALL TEXT.APPEND 'Value: ' S.1 S.0
    CALL LCD.WRITE 33.0 90.0 S.0
    MOVE32_32 0 STOPLCDUPDATE
	UI_DRAW UPDATE
    DATA8 layer741
	DATA8 no741
	DATA8 mode8741
	
	MOVEF_8 VLV_SENS_22 no741
	SUB8 no741 1 no741
	DIV8 no741 4 layer741
	MATH MOD8 no741 4 no741

	MOVEF_8 VLV_SENS_MODE_22 mode8741
	
	INPUT_DEVICE READY_RAW layer741 no741 0 mode8741 0
RETSUB_M_RGB_DETECT_3:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_RGB_DETECT_3:
SUB_M_RGB_GRITAR_1:
    JR_NEQF VLV_COLOR_23 0.0 else742_1
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Zero'
    JR endif742
  else742_1:
    JR_NEQF VLV_COLOR_23 1.0 else742_2
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Black'
    JR endif742
  else742_2:
    JR_NEQF VLV_COLOR_23 2.0 else742_3
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/BLUE'
    JR endif742
  else742_3:
    JR_NEQF VLV_COLOR_23 3.0 else742_4
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/GREEN'
    JR endif742
  else742_4:
    JR_NEQF VLV_COLOR_23 4.0 else742_5
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/YELLOW'
    JR endif742
  else742_5:
    JR_NEQF VLV_COLOR_23 5.0 else742_6
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/RED'
    JR endif742
  else742_6:
    JR_NEQF VLV_COLOR_23 6.0 else742_7
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/White'
    JR endif742
  else742_7:
    JR_NEQF VLV_COLOR_23 7.0 else742_8
    CALL SPEAKER.PLAY 100.0 'WRO2025/Media/Brown'
  else742_8:
  endif742:
    SOUND_READY
RETSUB_M_RGB_GRITAR_1:
    SUB8 STACKPOINTER 1 STACKPOINTER
    READ32 RETURNSTACK STACKPOINTER INDEX
    JR_DYNAMIC INDEX
ENDSUB_M_RGB_GRITAR_1:
}
subcall SPEAKER.PLAY    // FSV 
{
	IN_F volume
	IN_S filename 252	

	// prepend a path to really reach the target file from the current working directory
	DATA8 vol 
	DATAS fullname 300
	MOVEF_8 volume vol

	STRINGS ADD '../../../..' filename fullname  // when using absolute path, go to file system top from the VM directory and then back down
	JR_EQ8 filename 47 absolutepath               // filename begins with a '/' - using absolute path
	STRINGS ADD '../prjs/' filename fullname      // by default use path relative to prjs folder (must go from the current VM directory to there)
absolutepath:
	
	SOUND PLAY vol fullname
}
subcall ARRAYSTORE_FLOAT   // FFFV
{
	IN_F index
	IN_F value	
	IN_16 handle
	
	DATA32 index32
	DATA32 len	
	MOVEF_32 index index32

	ARRAY SIZE handle len
	JR_LT32 index32 0 negativeindex
	JR_LT32 index32 len arraybigenough

increasesize:	
	DATA32 doublelen
	ADD32 len len doublelen
	ARRAY RESIZE handle doublelen
writeloop:	
	ARRAY_WRITE handle len 0.0
	ADD32 len 1 len
	JR_LT32 len doublelen writeloop
	JR_GTEQ32 index32 len increasesize
	
arraybigenough:
	ARRAY_WRITE handle index32 value
negativeindex:
}
subcall ARRAYGET_FLOAT     // FFF
{
	IN_F index
	OUT_F value
	IN_16 handle
	
	DATA32 index32
	DATA32 len
	MOVEF_32 index index32
	
	ARRAY SIZE handle len
	JR_LT32 index32 0 outofbounds
	JR_GTEQ32 index32 len outofbounds
	
	ARRAY_READ handle index32 value
	RETURN
outofbounds:
	MOVE8_F 0 value	
}
subcall EV3.BATTERYVOLTAGE  // F
{
	OUT_F voltage
	UI_READ GET_VBATT voltage
}
subcall MOTOR.STOP       // SSV      MOTORDECODEPORTSDESCRIPTOR
{
	IN_S ports 8
	IN_S brake 8

	DATA8 layer
	DATA8 nos	
	DATA8 brk
	
	CALL MOTORDECODEPORTSDESCRIPTOR ports layer nos
	JR_EQ8 nos 0 noport

	AND8888_32 brake -538976289 brake        // AND 0xdfdfdfdf performs an upcase for 4 letters
    STRINGS COMPARE brake 'TRUE' brk	
	
	OUTPUT_STOP layer nos brk
noport:
}
subcall MOTORDECODEPORTSDESCRIPTOR  //  V
{
	IN_S descriptor 8
	OUT_8 layer
	OUT_8 nos

	DATA8 i 
	DATA8 c

	MOVE8_8 0 layer
	MOVE8_8 0 nos	
	MOVE8_8 0 i
loop:
	READ8 descriptor i c
	JR_EQ8 c 0 decoding_end
	
	JR_LT8 c 65 no_uppercase_port
	JR_GT8 c 68 no_uppercase_port
	SUB8 c 65 c
	RL8  1 c c
	OR8  nos c nos
	JR loop_end
no_uppercase_port:
	JR_LT8 c 97 no_lowercase_port
	JR_GT8 c 100 no_lowercase_port
	SUB8 c 97 c
	RL8  1 c c
	OR8  nos c nos	
	JR loop_end
no_lowercase_port:
	JR_LT8 c 49 loop_end
	JR_GT8 c 52 loop_end
	SUB8 c 49 layer
loop_end:
	ADD8 1 i i
	JR loop	
	
decoding_end:
	RETURN
}
subcall MOTOR.GETCOUNT    // SF     MOTORDECODEPORTDESCRIPTOR
{
	IN_S port 8
	OUT_F result
	
	DATA8 layer
	DATA8 no
	DATA32 tacho
	
	CALL MOTORDECODEPORTDESCRIPTOR port layer no
	JR_LT8 no 0 noport
	
	OUTPUT_GET_COUNT layer no tacho
	MOVE32_F tacho result

	DATA8 nos
	RL8 1 no nos
	DATA8 inv
	READ8 MOTORISINVERTED layer inv 
	AND8 inv nos inv
	JR_EQ8 inv 0 noinvert
	SUBF 0.0 result result
noinvert:
	RETURN

noport:	
	MOVE8_F 0 result	
}
subcall MOTORDECODEPORTDESCRIPTOR  //  V
{
	IN_S descriptor 8
	OUT_8 layer
	OUT_8 no

	DATA8 i 
	DATA8 c

	MOVE8_8 0 layer
	MOVE8_8 -1 no
	MOVE8_8 0 i
loop:
	READ8 descriptor i c
	JR_EQ8 c 0 decoding_end
	
	JR_LT8 c 65 no_uppercase_port
	JR_GT8 c 68 no_uppercase_port
	SUB8 c 65 c
	MOVE8_8 c no
	JR loop_end
no_uppercase_port:
	JR_LT8 c 97 no_lowercase_port
	JR_GT8 c 100 no_lowercase_port
	SUB8 c 97 c
	MOVE8_8 c no
	JR loop_end
no_lowercase_port:
	JR_LT8 c 49 loop_end
	JR_GT8 c 52 loop_end
	SUB8 c 49 layer
loop_end:
	ADD8 1 i i
	JR loop	
	
decoding_end:
	RETURN
}
subcall MOTOR.SCHEDULESYNC   // SFFFSV    MOTORSCHEDULESTEERIMPL
{
	IN_S ports 8
	IN_F speed1
	IN_F speed2
	IN_F count
	IN_S brake 8
	
	JR_GTEQF speed1 -100.0 nottoosmall1
	MOVEF_F -100.0 speed1
nottoosmall1:
	JR_LTEQF speed1 100.0 nottoobig1
	MOVEF_F 100.0 speed1
nottoobig1:
	JR_GTEQF speed2 -100.0 nottoosmall2
	MOVEF_F -100.0 speed2
nottoosmall2:
	JR_LTEQF speed2 100.0 nottoobig2
	MOVEF_F 100.0 speed2
nottoobig2:

	DATAF speed  
	DATAF turn
	MOVE8_F 0 speed
	MOVE8_F 0 turn

	DATAF speed1abs
	DATAF speed2abs
	MATH ABS speed1 speed1abs
	MATH ABS speed2 speed2abs
	JR_LTF speed1abs speed2abs secondisfaster
	JR_EQF speed1abs 0.0 donecomputation
	 MOVEF_F speed1 speed
	 MULF 100.0 speed2 turn
	 DIVF turn speed1 turn
	 SUBF 100.0 turn turn
	JR donecomputation
secondisfaster:
	 MOVEF_F speed2 speed
	 MULF 100.0 speed1 turn
	 DIVF turn speed2 turn
	 SUBF turn 100.0 turn
donecomputation:
	
	CALL MOTORSCHEDULESTEERIMPL ports speed turn count brake
}
subcall MOTORSCHEDULESTEERIMPL   // SFFFSV    MOTORDECODEPORTSDESCRIPTOR
{
	IN_S ports 8
	IN_F speed
	IN_F turn
	IN_F count
	IN_S brake 8
	
	DATA8 layer
	DATA8 nos	
	DATA8 first
	DATA8 second
	DATA8 invfirst
	DATA8 invsecond
	
	CALL MOTORDECODEPORTSDESCRIPTOR ports layer nos
	READ8 FIRSTOF2 nos first
	JR_EQ8 0 first not_two_ports
	XOR8 first nos second
	READ8 MOTORISINVERTED layer invfirst
	AND8 first invfirst invfirst
	READ8 MOTORISINVERTED layer invsecond
	AND8 second invsecond invsecond

	JR_LTF turn 0.0 second_is_master
first_is_master:
	JR_EQ8 invfirst 0 non_invert_first
	SUBF 0.0 speed speed
	JR_NEQ8 invsecond 0 done_inversion
	SUBF 200.0 turn turn
	JR done_inversion
non_invert_first:
	JR_EQ8 invsecond 0 done_inversion
	SUBF 200.0 turn turn
	JR done_inversion

second_is_master:
	JR_EQ8 invsecond 0 non_invert_second
	SUBF 0.0 speed speed
	JR_NEQ8 invfirst 0 done_inversion
	SUBF -200.0 turn turn
	JR done_inversion
non_invert_second:
	JR_EQ8 invfirst 0 done_inversion
	SUBF -200.0 turn turn
	JR done_inversion

done_inversion:
	DATA32 cnt
	DATA8 brk
	MATH ABS count count
	MOVEF_32 count cnt
	AND8888_32 brake -538976289 brake        // AND 0xdfdfdfdf performs an upcase for 4 letters
    STRINGS COMPARE brake 'TRUE' brk	

	JR_LTEQ32 cnt 0 dontmove	

	DATA8 spd  
	DATA16 trn
	MOVEF_16 turn trn
	MOVEF_8 speed spd
	OUTPUT_STEP_SYNC layer nos spd trn cnt brk	
dontmove:	
not_two_ports:
}
subcall SENSOR.READPERCENT       // FF
{
	IN_F port
	OUT_F result

	DATA8 layer
	DATA8 no
	DATA8 percentage

	MOVEF_8 port no
	SUB8 no 1 no
	DIV8 no 4 layer
	MATH MOD8 no 4 no

	INPUT_READ layer no 0 -1 percentage
	JR_LT8 percentage 0 novalue
	
	MOVE8_F percentage result
	RETURN
novalue:	
	MOVE8_F 0 result
}
subcall MOTOR.STARTSYNC      // SFFV       MOTORSTARTSTEERIMPL
{
	IN_S ports 8
	IN_F speed1
	IN_F speed2

	JR_GTEQF speed1 -100.0 nottoosmall1
	MOVEF_F -100.0 speed1
nottoosmall1:
	JR_LTEQF speed1 100.0 nottoobig1
	MOVEF_F 100.0 speed1
nottoobig1:
	JR_GTEQF speed2 -100.0 nottoosmall2
	MOVEF_F -100.0 speed2
nottoosmall2:
	JR_LTEQF speed1 100.0 nottoobig2
	MOVEF_F 100.0 speed2
nottoobig2:

	DATAF speed  
	DATAF turn
	MOVE8_F 0 speed
	MOVE8_F 0 turn

	DATAF speed1abs
	DATAF speed2abs
	MATH ABS speed1 speed1abs
	MATH ABS speed2 speed2abs
	JR_LTF speed1abs speed2abs secondisfaster
	JR_EQF speed1abs 0.0 donecomputation
	 MOVEF_F speed1 speed
	 MULF 100.0 speed2 turn
	 DIVF turn speed1 turn
	 SUBF 100.0 turn turn
	JR donecomputation
secondisfaster:
	 MOVEF_F speed2 speed
	 MULF 100.0 speed1 turn
	 DIVF turn speed2 turn
	 SUBF turn 100.0 turn
donecomputation:

	CALL MOTORSTARTSTEERIMPL ports speed turn
}
subcall MOTORSTARTSTEERIMPL      // SFFV       MOTORDECODEPORTSDESCRIPTOR
{
	IN_S ports 8
	IN_F speed
	IN_F turn

	DATA8 layer
	DATA8 nos	
	DATA8 first
	DATA8 second
	DATA8 invfirst
	DATA8 invsecond

	CALL MOTORDECODEPORTSDESCRIPTOR ports layer nos
	READ8 FIRSTOF2 nos first
	JR_EQ8 0 first not_two_ports
	XOR8 first nos second
	READ8 MOTORISINVERTED layer invfirst
	AND8 first invfirst invfirst
	READ8 MOTORISINVERTED layer invsecond
	AND8 second invsecond invsecond

	JR_LTF turn 0.0 second_is_master
first_is_master:
	JR_EQ8 invfirst 0 non_invert_first
	SUBF 0.0 speed speed
	JR_NEQ8 invsecond 0 done_inversion
	SUBF 200.0 turn turn
	JR done_inversion
non_invert_first:
	JR_EQ8 invsecond 0 done_inversion
	SUBF 200.0 turn turn
	JR done_inversion

second_is_master:
	JR_EQ8 invsecond 0 non_invert_second
	SUBF 0.0 speed speed
	JR_NEQ8 invfirst 0 done_inversion
	SUBF -200.0 turn turn
	JR done_inversion
non_invert_second:
	JR_EQ8 invfirst 0 done_inversion
	SUBF -200.0 turn turn
	JR done_inversion

done_inversion:
	DATA8 spd  
	DATA16 trn
	MOVEF_16 turn trn
	MOVEF_8 speed spd
	OUTPUT_STEP_SYNC layer nos spd trn 0 0
not_two_ports:
}
subcall SENSOR.GETMODE		// FF
{
	IN_F port
	OUT_F result
	
	DATA8 layer
	DATA8 no
	DATA8 type
	DATA8 mode
	
	MOVEF_8 port no
	SUB8 no 1 no
	DIV8 no 4 layer
	MATH MOD8 no 4 no
	
	INPUT_DEVICE GET_TYPEMODE layer no type mode
	MOVE8_F mode result
}
subcall LCD.CLEAR   // V
{
	UI_DRAW(TOPLINE,0)
	UI_DRAW(CLEAN)
	
	JR_NEQ32 0 STOPLCDUPDATE skipupdate
	UI_DRAW UPDATE
skipupdate:
}
subcall SENSOR.READRAW            // FFA
{
	IN_F port
	IN_F values
	IN_16 resultarray
	
	DATA8 layer
	DATA8 no
	DATA32 values32
		
	MOVEF_8 port no
	SUB8 no 1 no
	DIV8 no 4 layer
	MATH MOD8 no 4 no

	MOVEF_32 values values32

	JR_LTEQ32 values32 0 arrayempty
	ARRAY RESIZE resultarray values32

	DATA32 rawvalue0
	DATA32 rawvalue1
	DATA32 rawvalue2
	DATA32 rawvalue3
	DATA32 rawvalue4
	DATA32 rawvalue5
	DATA32 rawvalue6
	DATA32 rawvalue7
	INPUT_READEXT layer no 0 -1 18 8 rawvalue0 rawvalue1 rawvalue2 rawvalue3 rawvalue4 rawvalue5 rawvalue6 rawvalue7
	
	DATA32 i
	DATA32 rawtmp
	MOVE32_32 0 i
loop:
	DATA8 tmp8
	DATAF tmpf

	MOVEF_F 0.0 tmpf
	JR_GTEQ32 i 8 nomoredata

	MOVE32_8 i tmp8
	READ32 rawvalue0 tmp8 rawtmp
	JR_LT32 rawtmp -1000000000 nomoredata
	MOVE32_F rawtmp tmpf

nomoredata:	
	ARRAY_WRITE resultarray i tmpf

	ADD32 i 1 i
	JR_LT32 i values32 loop
	RETURN

arrayempty:
	ARRAY RESIZE resultarray 0
}
subcall TEXT.APPEND     // SSS
{
	IN_S a 252
	IN_S b 252
    OUT_S result 252
	
	DATA16 len0
	DATA16 len1
	DATA16 sum

	STRINGS GET_SIZE a len0
	STRINGS GET_SIZE b len1
	ADD16 len0,len1,sum
	JR_GT16 sum,251,stringsizeexceeded

	STRINGS ADD a b result
	RETURN
	
stringsizeexceeded:	
    STRINGS DUPLICATE a result
}
subcall LCD.WRITE     // FFSV
{
	IN_F x
	IN_F y
	IN_S text 252
	
	DATA16 x_16
	DATA16 y_16
	MOVEF_16 x x_16
	MOVEF_16 y y_16
	
	UI_DRAW SELECT_FONT 1
	UI_DRAW TEXT 1 x_16 y_16 text

	JR_NEQ32 0 STOPLCDUPDATE skipupdate
	UI_DRAW UPDATE
skipupdate:
}
subcall ARRAYCREATE_FLOAT   // F
{
	OUT_16 handle
	
	ARRAY CREATEF 8 handle			// create with 8 elements
	ARRAY FILL handle 0.0
}
